<html>
<head>
	<meta charset="UTF-8"> 
	<style>body,p,div,span,ul,ol{padding:0;margin:0}html,body{background-color:#444;color:white;width:100%;height:100%;overflow:auto}#load{width:90%;margin-left:0}#dropzone{display:block;width:100%;margin:24pt;padding:48pt 0 48pt 0;border:2pt solid silver;border-radius:16pt;background:transparent;text-align:center;font-size:xx-large;cursor:pointer}#dropzone.drag{border:4pt solid silver}#log{visibility:hidden}#help{width:100%;margin:24pt}#help p{margin-bottom:8pt}#logpath{font-family:courier}#matches{width:100%;margin:24pt}#matches a{color:white}#matches li{display:block;width:auto;list-style-type:none;padding:8pt;border:1pt solid silver;border-radius:8pt;margin-bottom:8pt}#matches .match-duration{margin:8pt}#matches .participant{padding:8pt}#main{width:100%;height:100%;display:flex;flex-direction:column}#main .lower{flex:1 1 auto;display:flex;flex-direction:row;overflow:hidden}#players{flex:0 1 auto;width:100%;clear:both;border-collapse:collapse;border:0 none black;color:gold;border:2pt solid gold}#players .info{width:25%;text-align:center;border-bottom:2pt solid gold;border:2pt solid gold}#players .info *{text-decoration:none;color:white}#players .info[data-quit]{text-decoration:white line-through}#players .mark-prestige,#players .mark-rot,#players .mark-stones,#players .mark-bounty{display:none;font:larger "Armello Icons";text-decoration:none;cursor:default}#players .info[data-prestige-leader] .mark-prestige{display:inline}#players .info[data-spirit-walker] .mark-stones{display:inline}#players .info[data-rotten] .mark-rot{display:inline}#players .info[data-bounty] .mark-bounty{display:inline}#players .player{width:25%;min-width:200pt;overflow:hidden;border:2pt solid gold;vertical-align:top;text-align:center}#players *[data-clan="Wolf"]{background-color:#3674A3}#players *[data-clan="Rabbit"]{background-color:#9F7714}#players *[data-clan="Bear"]{background-color:#006006}#players *[data-clan="Rat"]{background-color:#9A2D36}#players *[data-clan="Bandit"]{background-color:#333}#players .equipped{width:100%;min-width:170pt;border-collapse:collapse;border:0 none black;margin-top:4pt;color:gold}#players .equipped td{padding:2pt 4pt}#players .equipped td.followers{border-left:1px solid gold}#players .stats{width:100%;min-width:170pt;border-collapse:collapse;color:gold}#players .stats td{text-align:left;padding:3pt 3pt 3pt 6pt}#players .stats td::before{font:larger "Armello Icons"}#players .stats .Fight::before{content:"F"}#players .stats .Body::before{content:"B "}#players .stats .Wits::before{content:"W"}#players .stats .Spirit::before{content:"S"}#players .stats .SpiritStones::before{content:"T"}#players .stats .Prestige::before{content:"P "}#players .stats .Health::before{content:"H "}#players .stats .Gold::before{content:"G "}#players .stats .Magic::before{content:"M "}#players .stats .Rot::before{content:"R "}#players .items,#players .followers{min-width:64pt;text-align:center}#players .hand{border-top:1px solid gold;margin:0 4pt 0 4pt;max-width:270pt}#players .effects{font-style:italic;margin:4pt;max-width:270pt}#turns{flex:0 0 auto;overflow-y:scroll;min-width:200pt;background-color:#666;cursor:default}#turns li{list-style:none;color:gold;border:1px none black}#turns li.event[selected]{background-color:darkblue;color:white}#turns li:hover{color:white;cursor:pointer}#turns li[selected]:hover{cursor:default}#turns li.Wolf{background-color:#3674A3}#turns li.Rabbit{background-color:#9F7714}#turns li.Bear{background-color:#006006}#turns li.Rat{background-color:#9A2D36}#turns li.Bandit{background-color:#333}#turns li.King{background-color:#4169E1}#turns li.Bane{background-color:#622078}#turns li.event-chat{font-style:italic}#turns li.event-nextRound{text-align:center;font-weight:bold}#turns li.event-nextRound::before{content:"======= "}#turns li.event-nextRound::after{content:" ======="}#turns li.event-startTurn{border-top:2px solid gold;text-align:center}#turns li.event-playerQuit{color:white;background-color:inherit;text-align:center;font-weight:bold}#turns li.event-victory{color:white;background-color:#4169E1;text-align:center;font-weight:bold}#turns li.event-attack::before,li.event-combatEnd::before{font:smaller "Armello Icons";content:"x "}#turns li.event-combatEnd .roll-tooltip{display:none;background-color:#222;color:#DDD;border:1px solid white;border-radius:8pt;margin-left:8pt;padding:2pt;cursor:default}#turns li.event-combatEnd:hover .roll-tooltip{display:table;position:absolute}#turns li.event-combatEnd[selected]{padding-bottom:4pt}#turns li.event-combatEnd[selected] .roll-tooltip,#turns li.event-combatEnd[selected]:hover .roll-tooltip{display:table;position:relative;width:90%}#turns .roll-tooltip .attacker-name{width:50%;text-align:left;font-weight:bold;padding-right:4pt}#turns .roll-tooltip .attacker{width:50%;text-align:left;border-bottom:1px solid white;padding-right:4pt}#turns .roll-tooltip .defender-name{width:50%;text-align:right;font-weight:bold;padding-left:4pt}#turns .roll-tooltip .defender{width:50%;text-align:right;border-bottom:1px solid white;padding-left:4pt}#turns .roll-tooltip .attacker-dice{font:smaller "Armello Icons";width:50%;text-align:right;padding-right:4pt}#turns li.event-combatEnd .roll-tooltip .defender-dice{font:smaller "Armello Icons";width:50%;text-align:left;padding-left:4pt}#turns .roll-tooltip .roll{padding:1pt}#turns .roll-tooltip .roll-Locked{color:white}#turns .roll-tooltip .roll-Burned{color:gold}#turns .roll-tooltip .roll-Rolled{color:silver}#turns .roll-tooltip .roll-Pierce{background-color:blue}#turns .roll-tooltip .roll-Reflect{background-color:blue}#turns .roll-tooltip .roll-Poison{background-color:green}.mapwrapper{background-color:#444;display:flex;flex:1 1 auto}#maptooltip{visibility:hidden;display:block;position:absolute;z-index:1;background-color:#222;color:#DDD;border-radius:2pt;padding:2pt;user-select:none;-webkit-user-select:none}#map{display:block;margin:auto;max-width:100%;max-height:100%}@font-face{font-family:'Armello Icons';src:url('data:application/octet-stream;base64,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') format('woff');font-weight:normal;font-style:normal}</style><noscript>
		<style> 
		#load {display:none;} 
		#main {display:none;} 
		body::before {
			display: block;
			margin: 24pt 5%;
			padding: 8pt;
			width: 90%;
			border: 1px solid white;
			border-radius: 12pt;
			font: 24pt Arial;
			content: "Armello Replay Tool can't work without JavaScript. Please, enable JavaScript and reload the page.";
		}
		</style>
	</noscript>
	<script>function Name(id){return(id in Name.db)?Name.db[id]:id;}
function Hint(id){return(id in Hint.db)?Hint.db[id]:"";}
function PCard(type){return'<span class="card" data-id="'+type+'" title="'+Hint(type)+'">'+Name(type)+'</span>';}
function PDecl(type){return'<span class="declaration" data-id="'+type+'" title="'+Hint(type)+'">'+Name(type)+'</span>';}
function PEnt(type,id){return'<span class="entity" data-id="'+id+'" title="'+Hint(type)+'">'+Name(type)+'</span>';}
Name.db={Bandit01:"Twiss",Bandit02:"Sylas",Bandit03:"Horace",Bandit04:"Scarlet",Bear01:"Sana",Bear02:"Brun",Bear03:"Ghor",Bear04:"Yordana",Rabbit01:"Amber",Rabbit02:"Barnaby",Rabbit03:"Elyssia",Rabbit04:"Hargrave",Rat01:"Mercurio",Rat02:"Zosha",Rat03:"Sargon",Rat04:"Griotte",Wolf01:"Thane",Wolf02:"River",Wolf03:"Magna",Wolf04:"Fang",King:"The King",KingsGuard:"King's Guard",Bane:"Bane",SIG01:"Black Opal",SIG02:"Obsidian",SIG03:"Ruby",SIG04:"Turquoise",SIG05:"Emerald",SIG06:"Pink Topaz",SIG07:"Diamond",SIG08:"Sunstone",SIG09:"Sapphire",SIG10:"Moonstone",SIG11:"Onyx",SIG12:"Celestite",SIG13:"Jade",SIG14:"Quartz",SIG15:"Amethyst",SIG16:"Amber",SIG17:"Tanzanite",SIG18:"Rainbow Quartz",SIG19:"Rubellite",SIG20:"Aquamarine",SIG21:"Serendibite",SIG22:"Cat's Eye",SIG23:"Spinel",SIG24:"Chrysocolla",SIG25:"Taaffeit",SIG26:"Black Opal",SIG27:"Pink Topaz",SIG28:"Amethyst",SIG29:"Celestite",AMU01:"Scratch Amulet",AMU02:"Soak Amulet",AMU03:"Think Amulet",AMU04:"Feel Amulet",AMU05:"Grow Amulet",AMU06:"Watch Amulet",AMU07:"Favour Amulet",AMU08:"Spoil Amulet",AMU10:"Dig Amulet",AMU11:"Sprint Amulet",AMU12:"Discipline Amulet",AMU13:"Resist Amulet",DECL_0001:"Tax Time",DECL_00016:"Rot Inspection",DECL_00017:"Fugitives Unleashed",DECL_00018:"Martial Law",DECL_00019:"Black Death",DECL_0002:"Tribute of Spirit",DECL_0003:"Peace Treaty",DECL_0004:"Beasts of Bane",DECL_0005:"For Royal Eyes Only",DECL_0006:"Royal Acquisition",DECL_0007:"The Underdog",DECL_0008:"Sinister Rituals",DECL_0009:"Healthcare",DECL_0010:"Blood Moon",DECL_0012:"King's Mercy",DECL_0013:"Dishonoured Defender",DECL_0014:"Royal Flush",DECL_0015:"Dark Liege",DECL_0020:"Civil Uprising",DECL_0021:"Palace Lockdown",DECL_0022:"War March",DECL_0023:"Fog of War",DECL_0024:"Royal Inquisition",DECL_0025:"Supreme Court",DECL_0026:"Treasury Visit",DECL_0027:"Desperate Defence",DECL_0028:"Desertion!",DECL_0029:"Life Support",DECL_0031:"Cursed Kingdom",DECL_0032:"Private Security",DECL_0033:"Total Famine",DECL_0034:"Dark Storms",DECL_0035:"Royal Challenge",DECL_0036:"Night Maneuvers",DECL_0037:"The Toll Bells Sing",DECL_0038:"Paws of Fate",DECL_0039:"King's Bounties",DECL_0040:"King's Agents",DECL_0041:"Darkest Night",DECL_0042:"Ripped Reality",DECL_0043:"Terror Awakened",DECL_0044:"Rotten Choir",DECL_0045:"Royal Stimulus",DECL_0046:"Rot Rain",DECL_0047:"Highway Fees",DECL_0048:"Green-Eyed Monsters",DECL_0049:"Sovereign City State",DECL_0050:"Burn After Reading",DECL_0051:"War Drums",KING01:"Crown of Armello",KING02:"Wyldhide",KING03:"Pride's Edge",PPN001:"Mother's Maze",PPS001:"The Unseen Death",PPW001:"Fool's Fountain",PPE001:"The Tricking Paths",CON01:"Wyld Weed",CON02:"Wyldsap",CON03:"Cub's Blood",CON04:"Throwing Axe",CON05:"Brazenberry Ale",CON06:"Moon Juice",CON07:"Hot Rot Wine",CON08:"Mountain Moss",CON09:"Bubble Tea",CON10:"Poisoned Gift",CON11:"Blackberry Dust",CON12:"Snake Venom",FOL01:"Alchemist",FOL02:"Apothecary",FOL03:"Warlock",FOL04:"Explorer",FOL05:"Apprentice",FOL06:"Blacksmith",FOL07:"The Stranger",FOL08:"Brilliant Fool",FOL09:"Bard",FOL10:"Poison Taster",FOL11:"Berserker",FOL12:"Squire",FOL13:"Conjurer",FOL14:"Diplomat",FOL15:"Miner",FOL16:"Spy Master",FOL17:"Coin Master",FOL18:"Trader",ITM01:"Helm of Heroes",ITM02:"Hand Cannons",ITM03:"Bane Blade",ITM04:"Royal Shield",ITM05:"Masquerade Mask",ITM06:"Moon Scythe",ITM07:"Bane's Claw",ITM08:"Royal Pardon",ITM09:"Winged Boots",ITM10:"Wyldfyre Staff",ITM11:"Trusty Shield",ITM12:"Shining Steel Sword",ITM13:"Adventurer's Kit",ITM14:"War Hammer",ITM15:"Battle Armour",ITM16:"Battle Axe",ITM17:"Marauder Gauntlets",ITM18:"Heavy Plate Armour",ITM19:"Royal Banner",ITM20:"Ranger's Cloak",ITM21:"War Horn",ITM22:"Lord's Scepter",ITM23:"Hare's Halberd",ITM24:"Spy Glass",ITM25:"Longbow",ITM26:"Sailor's Lantern",ITM27:"Oak Spear",ITM28:"Heavy Flail",ITM29:"Feathered Helm",ITM30:"Chainmail Shirt",ITM31:"Bastard Sword",ITM32:"Raven's Beak Dagger",ITM33:"Wyld Talisman",ITM34:"Mirror Cape",ITM35:"Poppet",ITM36:"Lionheart Breastplate",ITM37:"Leather Armour",ITM38:"Poisoned Dagger",ITM40:"Torch",ITM41:"Tower Shield",ITM42:"Iron Pike",ITM45:"Hero's Shield",ITM47:"Silver Lance",ITM48:"Reaper's Trident",ITM50:"King's Guard Armour",ITM52:"Mahogany Staff",MAG01:"Haste",MAG02:"Tanglevine",MAG03:"Bloodthirst",MAG04:"Lightning Strike",MAG05:"Immolation",MAG06:"Syphon",MAG07:"Spirit Strike",MAG08:"Malice Rising",MAG09:"Focus",MAG10:"Rite of Wyld",MAG11:"Aflame",MAG12:"Banish",MAG13:"Regeneration",MAG14:"Crystallise",MAG15:"Plague",MAG16:"Wyld's Warning",MAG17:"Dark Influence",MAG18:"The Cleansing Wyld",MAG19:"Wake the Trees",MAG20:"Glamour",MAG21:"Blizzard",MAG22:"Mirror Image",MAG23:"Bark Skin",MAG24:"Feral",MAG25:"Moonbite",MAG26:"Evil Eye",MAG27:"Wyld Born",MAG28:"Cursed Lands",MAG29:"Teleport",MAG30:"Wall of Thorns",MAG31:"Shimmer Shield",MAG32:"Call of the Worm",MAG33:"Divination",MAG34:"Leech",MAG36:"Spirit Seeds",MAG46:"Rotten Fog",TRK01:"Hoodwinked",TRK02:"Slanderous Toads",TRK03:"False Orders",TRK04:"Mercenaries",TRK05:"Merry Thieves",TRK06:"Disguise",TRK07:"Rangers",TRK08:"Saboteur",TRK09:"Reprieve",TRK10:"Spy Network",TRK11:"Grand Heist",TRK12:"Strategist",TRK13:"Patronage & Industry",TRK14:"Crime Lord",TRK15:"Game of Thorns",TRK16:"Incite Revolt",TRK17:"Witch Hunters",TRK18:"Bounty",TRK19:"Cat Burglar",TRK20:"Beheaded",TRK21:"Expendables",TRK22:"Bribery",TRK23:"Plague Bearers",TRK24:"Merchant's Agreement",TRK25:"Allies' Pact",TRK26:"Wandering Circus",TRK27:"Crooks",TRK28:"Vile Official",TRK29:"Agent of Misfortune",TRK30:"Hidden Trap",TRK31:"Pick Pockets",TRK32:"Welcoming Party",TRK33:"Emissary",TRK34:"Armistice",TRK35:"Blood Money",TRK36:"Blackmail",TRK37:"Stone Wards",TRK38:"Betty's Bargain Brews",TRK39:"Simeon's Arms",TRK38PRE:"Awaiting Betty's Bargain Brews",TRK39PRE:"Awaiting Simeon's Arms",TRK42:"Sharpshooter",TRK43:"Arson",TRK44:"Roxy's Recruiting",TRK45:"Biff's Black Market",TRK44PRE:"Awaiting Roxy's Recruiting",TRK45PRE:"Awaiting Biff's Black Market",TRK46:"Palisade Walls",BRW01:"Curse of Valour",BRW02:"Ill Fortune",BRW03:"Curse of Eye",BRW04:"Bloodletting",BRW05:"Curse of Skill",ClanCastle:"Clan Grounds",KingsPalace:"The Palace",KingTile:"Throne Room",Plains:"Plains",Forest:"Forest",Swamp:"Swamp",Mountains:"Mountains",StoneCircle:"Stone Circle",Dungeon:"Dungeon",Settlement:"Settlement",};Hint.db={Bandit01:"Pickpocket: Has Evade everywhere except in the Palace. Upon escape, Twiss steals 1 card from her opponent.",Bandit02:"Butcher: For every King's Guard killed, Sylas gains +1 Sword in Battle. Cleared upon death.",Bandit03:"9th Knight: King's Guards will trade tiles with Horace if he moves into their tile, unless he has a Bounty.",Bandit04:"Revolutionary: Scarlet draws a follower card every time she 'rescues' a Terrorized Settlement.",Bear01:"Priestess: When in combat with any corrupted Creature, Sana uses her Spirit as her Fight.",Bear02:"Scarcaster: For every spell cast gain +1 Fight until after Battle or until the end of the next turn.",Bear03:"Conduit: When on a Forest tile, Spells cost 1 Magic less per current and adjacent forest and Ghor can cast to any Forest.",Bear04:"Cauldron Crone: Spells cast to Yordana during her turn are devoured in her cauldron for -1 Magic, granting a Pact Spell at the end of her turn.",Rabbit01:"Tomb Raider: Always have better outcomes when Exploring Dungeons.",Rabbit02:"Tinkerer: Equipping over an Item in your inventory will return that Item to your hand with the cost/gain removed.",Rabbit03:"Architect: Elyssia permanently fortifies settlements she ends her turn on. Fortified settlements grant a bonus defense while in them and cost opponents an extra AP to move into.",Rabbit04:"Cannoneer: After ending his turn on a Plains or Mountain, Hargrave will fire his cannon at any creature entering an adjacent tile. ",Rat01:"Scoundrel: Steal 1 gold from the owner of a Settlement when you claim it.",Rat02:"Shadow: At Night, Zosha gains Stealth everywhere but the Palace.",Rat03:"Veil Gazer: During the draw phase, all cards are face up.",Rat04:"Street Queen: Griotte's Clan Affinity Dice is equal to the number of Trickery Cards played the previous Day.",Wolf01:"Sword Master: Sword cards Burned in Battle Pierce enemy Shields.",Wolf02:"Huntress: When attacking, River shoots her bow for 1 damage before initiating battle. If her target is killed by this ability, River won't move, but still consumes an Action Point.",Wolf03:"Shield Maiden: Shield cards Burned in Battle reflect damage back at her opponent.",Wolf04:"Berzerker: When attacking, if Fang Slaughters his opponent, Battle ends before they strike back.",King:"The King",KingsGuard:"King's Guard",Bane:"Bane",SIG01:"Gain Stealth in Settlements Day and Night.",SIG02:"At Night, Gain Scout on all your claimed Settlements.",SIG03:"First rolled Sword in Battle Explodes.",SIG04:"Gain the Evade Ability.",SIG05:"Gain +2 Shield on Plains in Battle and Perils.",SIG06:"Doubles Income gained from Settlements.",SIG07:"Gain 1 Prestige for each Treasure Equipped and Follower Recruited.",SIG08:"In Battle and Perils, +1 Sun result while you have more than 3 Gold.",SIG09:"Gain Stealth on Mountains, Day and Night.",SIG10:"Gain +1 Magic for any Kill in Battle.",SIG11:"Gain +1 Gold for any Kill in Battle.",SIG12:"Ignore Mountain movement penalty.",SIG13:"Gain +3 Magic if you are in a Forest at Dawn.",SIG14:"-1 Rot if you are in a Stone Circle at Dawn.",SIG15:"Gain +1 Magic for every Spell Card Burned.",SIG16:"Burning Sun And Moon cards in Battle is always considered a Hit.",SIG17:"+1 Gold when you escape a Peril.",SIG18:"+1 Magic every dawn.",SIG19:"+3 Fight when you have less than 4 health.",SIG20:"+1 Moon in Battle and Perils if you have 0 Rot.",SIG21:"Gain +1 Gold and Prestige each time you kill a King's Guard.",SIG22:"Get a 1 Gold discount on first Trickery Card played each turn.",SIG23:"Get a 10% bonus in all Quests.",SIG24:"Grants Scout on Heroes with 2 Health or less.",SIG25:"+1 Shield in Forests.",SIG26:"Gain Stealth in Settlements Day and Night.",SIG27:"Doubles Income gained from Settlements.",SIG28:"Gain +1 Magic for every Spell Card Burned.",SIG29:"Ignore Mountain movement penalty.",AMU01:"+1 Fight.",AMU02:"+1 Body.",AMU03:"+1 Wits.",AMU04:"+1 Spirit.",AMU05:"+1 Health at Dusk.",AMU06:"Guaranteed first symbol match when facing perils.",AMU07:"Start game with 2 Prestige.",AMU08:"Start game with 2 Rot.",AMU10:"Increased chance of finding Spirit Stones when exploring Dungeons.",AMU11:"Gain 1 AP the turn after you die.",AMU12:"Double Clan Affinity dice.",AMU13:"Gain 1 Shield in Battle and Perils",DECL_0001:"Lose 2 gold. If not enough gold, lose 1 prestige.",DECL_00016:"Any hero with 1 or more Rot loses 1 prestige.",DECL_00017:"Four trickery perils appear in the Kingdom.",DECL_00018:"King's guards immediately move to the nearest settlement and terrorize them. Will not fight any heroes currently on settlements.",DECL_00019:"Plague Perils ravage Armello's settlements. Settlements that already have a peril are spared.",DECL_0002:"Lose 2 magic. If not enough magic, lose 1 prestige.",DECL_0003:"Heroes that attack another hero lose 3 prestige until the next dawn.",DECL_0004:"3 Banes will spawn at night.",DECL_0005:"Any hero currently in a stone circle or dungeon, or who enters one before the next dawn, receives a bounty.",DECL_0006:"Steals one randomly equipped item from each hero, if no items are equipped -2 prestige.",DECL_0007:"The hero with the lowest prestige gets a random treasure.",DECL_0008:"All Banes on the map get +2 Fight and +2 Body until next Dawn.",DECL_0009:"Pay 4 gold, if you have less than 4 gold you will become poisoned.",DECL_0010:"Every hero gains +1 rot.",DECL_0012:"The King orders the prestige leader to pass around their renown, giving every other hero 1 prestige.",DECL_0013:"-3 prestige to the prestige leader for their poor performance. King's guards get +2 fight and body.",DECL_0014:"All heroes discard their current hand.",DECL_0015:"Summon four banes to the palace at dawn (will not eject current occupants).",DECL_0020:"All settlements become terrorized.",DECL_0021:"The King places a bounty on the prestige leader's head and recalls all idle King's guards back to the palace.",DECL_0022:"All heroes have bounties put on their heads.",DECL_0023:"All heroes are stealthed until dawn, unless revealed by entering combat or failing a peril.",DECL_0024:"Infected heroes lose 1 HP. Corrupted heroes lose 3 HP.",DECL_0025:"All heroes lose 3 prestige.",DECL_0026:"The prestige leader gives up all of their gold. If they had 5 gold or more, they gain 1 prestige, if not they lose 1 prestige.",DECL_0027:"All palace perils are removed; guards with 1 HP are spawned in their place if the tile was empty.",DECL_0028:"All guards defending the Palace disappear.",DECL_0029:"The King and the prestige leader heal for 1 HP.",DECL_0031:"The King plays Cursed Lands to all normal perils.",DECL_0032:"Plays Mercenaries on all settlements without other perils.",DECL_0033:"Lose 2 gold. If not enough gold, lose 2 health.",DECL_0034:"The King plays 4 Lightning Strike perils to random tiles.",DECL_0035:"Prestige leader given Bounty and +4 Gold.",DECL_0036:"King's guards attack heroes at night (regardless of whether or not you have a bounty).",DECL_0037:"The King loses 2 fight for the rest of the game and a Lightning Strike hits every creature currently inside the palace.",DECL_0038:"Each hero swaps their current hand with another random hero.",DECL_0039:"All bounties are worth +1 extra gold and prestige for the rest of the game.",DECL_0040:"Plays Agent of Misfortune to all existing perils (-1 health per unmatched symbol during peril).",DECL_0041:"Darkest Night",DECL_0042:"Random stone circles received a Banish peril.",DECL_0043:"All banes gain +1 Fight and +1 AP for the rest of the game.",DECL_0044:"Every creature loses 1 Body.",DECL_0045:"Until next dawn, King gives 2 gold for every AP not spent.",DECL_0046:"At dusk, every hero and guard not in a settlement, in the palace, or in their clan grounds takes -2 health.",DECL_0047:"Until next dawn, pay 2 Gold to enter every settlement.",DECL_0049:"One unclaimed settlement gets permanently fortified and Mercenaries and Agent of Misfortune is applied.",DECL_0050:"-2 Prestige from prestige leader and hand is discarded, all drawing decks are re-shuffled and leader gets new random full hand.",DECL_0051:"Bounties to all heroes, add 2 King's Guard.",CON01:"Wyld Weed",CON02:"Wyldsap",CON03:"Cub's Blood",CON04:"Throwing Axe",CON05:"Brazenberry Ale",CON06:"Moon Juice",CON07:"Hot Rot Wine",CON08:"Mountain Moss",CON09:"Bubble Tea",CON10:"Poisoned Gift",CON11:"Blackberry Dust",CON12:"Snake Venom",FOL01:"Alchemist",FOL02:"Apothecary",FOL03:"Warlock",FOL04:"Explorer",FOL05:"Apprentice",FOL06:"Blacksmith",FOL07:"The Stranger",FOL08:"Brilliant Fool",FOL09:"Bard",FOL10:"Poison Taster",FOL11:"Berserker",FOL12:"Squire",FOL13:"Conjurer",FOL14:"Diplomat",FOL15:"Miner",FOL16:"Spy Master",FOL17:"Coin Master",FOL18:"Trader",ITM01:"Helm of Heroes",ITM02:"Hand Cannons",ITM03:"Bane Blade",ITM04:"Royal Shield",ITM05:"Masquerade Mask",ITM06:"Moon Scythe",ITM07:"Bane's Claw",ITM08:"Royal Pardon",ITM09:"Winged Boots",ITM10:"Wyldfyre Staff",ITM11:"Trusty Shield",ITM12:"Shining Steel Sword",ITM13:"Adventurer's Kit",ITM14:"War Hammer",ITM15:"Battle Armour",ITM16:"Battle Axe",ITM17:"Marauder Gauntlets",ITM18:"Heavy Plate Armour",ITM19:"Royal Banner",ITM20:"Ranger's Cloak",ITM21:"War Horn",ITM22:"Lord's Scepter",ITM23:"Hare's Halberd",ITM24:"Spy Glass",ITM25:"Longbow",ITM26:"Sailor's Lantern",ITM27:"Oak Spear",ITM28:"Heavy Flail",ITM29:"Feathered Helm",ITM30:"Chainmail Shirt",ITM31:"Bastard Sword",ITM32:"Raven's Beak Dagger",ITM33:"Wyld Talisman",ITM34:"Mirror Cape",ITM35:"Poppet",ITM36:"Lionheart Breastplate",ITM37:"Leather Armour",ITM38:"Poisoned Dagger",ITM40:"Torch",ITM41:"Tower Shield",ITM42:"Iron Pike",ITM45:"Hero's Shield",ITM47:"Silver Lance",ITM48:"Reaper's Trident",ITM50:"King's Guard Armour",ITM52:"Mahogany Staff",MAG01:"Haste",MAG02:"Tanglevine",MAG03:"Bloodthirst",MAG04:"Lightning Strike",MAG05:"Immolation",MAG06:"Syphon",MAG07:"Spirit Strike",MAG08:"Malice Rising",MAG09:"Focus",MAG10:"Rite of Wyld",MAG11:"Aflame",MAG12:"Banish",MAG13:"Regeneration",MAG14:"Crystallise",MAG15:"Plague",MAG16:"Wyld's Warning",MAG17:"Dark Influence",MAG18:"The Cleansing Wyld",MAG19:"Wake the Trees",MAG20:"Glamour",MAG21:"Blizzard",MAG22:"Mirror Image",MAG23:"Bark Skin",MAG24:"Feral",MAG25:"Moonbite",MAG26:"Evil Eye",MAG27:"Wyld Born",MAG28:"Cursed Lands",MAG29:"Teleport",MAG30:"Wall of Thorns",MAG31:"Shimmer Shield",MAG32:"Call of the Worm",MAG33:"Divination",MAG34:"Leech",MAG36:"Spirit Seeds",MAG46:"Rotten Fog",TRK01:"Hoodwinked",TRK02:"Slanderous Toads",TRK03:"False Orders",TRK04:"Mercenaries",TRK05:"Merry Thieves",TRK06:"Disguise",TRK07:"Rangers",TRK08:"Saboteur",TRK09:"Reprieve",TRK10:"Spy Network",TRK11:"Grand Heist",TRK12:"Strategist",TRK13:"Patronage & Industry",TRK14:"Crime Lord",TRK15:"Game of Thorns",TRK16:"Incite Revolt",TRK17:"Witch Hunters",TRK18:"Bounty",TRK19:"Cat Burglar",TRK20:"Beheaded",TRK21:"Expendables",TRK22:"Bribery",TRK23:"Plague Bearers",TRK24:"Merchant's Agreement",TRK25:"Allies' Pact",TRK26:"Wandering Circus",TRK27:"Crooks",TRK28:"Vile Official",TRK29:"Agent of Misfortune",TRK30:"Hidden Trap",TRK31:"Pick Pockets",TRK32:"Welcoming Party",TRK33:"Emissary",TRK34:"Armistice",TRK35:"Blood Money",TRK36:"Blackmail",TRK37:"Stone Wards",TRK38:"Betty's Bargain Brews",TRK39:"Simeon's Arms",TRK42:"Sharpshooter",TRK43:"Arson",TRK46:"Palisade Walls",};</script>
	<script>function Observable()
{Object.defineProperty(this,'_observers',{value:new Array(),enumerable:false,writable:false,configurable:false,});}
Observable.prototype={constructor:Observable,subscribe:function(handler)
{this._observers.push(handler);},unsubscribe:function(handler)
{var index=this._observers.indexOf(handler);if(index>=0)
this._observers.splice(index,1);},notify:function(property,action,value)
{let args=Array.prototype.slice.call(arguments);args.unshift(this);for(var i=0;i<this._observers.length;i++)
try
{this._observers[i].apply(null,args);}
catch(e)
{console.error(e);}},};function SerializableObservableCollection()
{Observable.call(this);this.items=[];Object.defineProperty(this,'_itemchanged',{value:Observable.prototype.notify.bind(this,'items','change'),enumerable:false,writable:false,configurable:false,});};SerializableObservableCollection.prototype=Object.create(Observable.prototype);SerializableObservableCollection.prototype.constructor=SerializableObservableCollection;SerializableObservableCollection.prototype.addItem=function(item)
{if(item instanceof Observable)
item.subscribe(this._itemchanged);this.items.push(item);this.notify('items','add',item);};SerializableObservableCollection.prototype.addNewItem=function(Class )
{var item=new(Function.prototype.bind.apply(Class,arguments));this.addItem(item);};SerializableObservableCollection.prototype.clearItems=function()
{for(var i=0;i<this.items.length;i++)
if(item instanceof Observable)
this.items[i].unsubscribe(handler);this.items.splice(0,this.items.length);this.notify('items','change');};SerializableObservableCollection.prototype.removeItem=function(item)
{var index=this.items.indexOf(item);if(index<0)
throw new Error(this.constructor.name+": Item "+item.toString()+" does not exist in collection "+this.toString());else
{if(item instanceof Observable)
item.unsubscribe(this._itemchanged);this.items.splice(index,1);this.notify('items','remove',item);}};SerializableObservableCollection.prototype.removeItemById=function(key,value,strict)
{for(var i=0;i<this.items.length;i++)
if(this.items[i][key]==value)
{let item=this.items[i];if(item instanceof Observable)
item.unsubscribe(this._itemchanged);this.items.splice(i,1);this.notify('items','remove',item);return;}
if((typeof strict==='undefined')||strict)
throw new Error(this.constructor.name+": There is no item with "+key.toString()+" = "+value.toString());};SerializableObservableCollection.prototype.getItemById=function(key,value,strict)
{for(var i=0;i<this.items.length;i++)
if(this.items[i].hasOwnProperty(key)&&(this.items[i][key]==value))
return this.items[i];if((typeof strict==='undefined')||strict)
throw new Error(this.constructor.name+": There is no item with "+key.toString()+" = "+value);};SerializableObservableCollection.prototype.serializeItems=function()
{return JSON.stringify(this.items);};SerializableObservableCollection.prototype.deserializeItems=function(data,reviver)
{var objectlist=JSON.parse(data);if(!Array.isArray(objectlist))
throw new Error("Invalid data - not an array");for(var i=0;i<this.items.length;i++)
if(this.items[i]instanceof Observable)
this.items[i].unsubscribe(this._itemchanged);this.items.splice(0,this.items.length);for(var i=0;i<objectlist.length;i++)
if(typeof reviver==='function')
{var newitem=reviver(objectlist[i]);if(newitem instanceof Observable)
newitem.subscribe(this._itemchanged);this.items.push(newitem);}
else
this.items.push(objectlist[i]);this.notify('items','change');};SerializableObservableCollection.getSimpleReviver=function(Class )
{return function(obj)
{var newitem=new(Function.prototype.bind.apply(Class,arguments));var keys=Object.keys(newitem);for(var k=0;k<keys.length;k++)
if(newitem.hasOwnProperty(keys[k]))
newitem[keys[k]]=obj[keys[k]];return newitem;};}
function Entity(id,type,coords)
{Observable.call(this);this.id=id;this.type=type;this.dead=false;this.corrupted=false;if(typeof coords!=='undefined')
this.coords=coords;else
this.coords="-1,-1";Object.defineProperty(this,'u',{get:function(){return Number.parseInt(this.coords.split(',')[0]);},enumerable:false,configurable:false,});Object.defineProperty(this,'v',{get:function(){return Number.parseInt(this.coords.split(',')[1]);},enumerable:false,configurable:false,});this.Fight=0;this.Body=0;this.Rot=0;this.Health=0;this.ActionPoints=0;this.effects=new Array();this.equipment=new Array();}
Entity.prototype=Object.create(Observable.prototype);Entity.prototype.constructor=Entity;Entity.prototype.moveTo=function(coords)
{this.coords=coords;this.notify('coords','change',this.coords);};Entity.prototype.setType=function(type)
{this.type=type;this.notify('type','change',type);};Entity.prototype.kill=function()
{this.dead=true;this.notify('dead','change',this.dead);};Entity.prototype.changeStat=function(stat,newvalue)
{if(this.hasOwnProperty(stat)&&(this[stat]!==newvalue))
{this[stat]=parseInt(newvalue,10);this.notify(stat,'change',this[stat]);}};Entity.prototype.equipCard=function(slot,card)
{this.equipment[slot]=card;this.notify('equipment','add',card);};Entity.prototype.unequipCard=function(slot,card)
{if(this.equipment[slot]==card)
{this.equipment[slot]=undefined;this.notify('equipment','remove',card);}
else
console.warn('Entity '+this.type+'('+this.id+') lost equipped card '+card+' in slot '+slot+' despite having '+this.equipment[slot]+' there.');};Entity.prototype.addEffect=function(effect)
{this.effects.push(effect);this.notify('effects','add',effect);};Entity.prototype.removeEffect=function(effect)
{var index=this.effects.indexOf(effect);if(index>=0)
{this.effects.splice(index,1);this.notify('effects','remove',effect);}
else
console.warn('Entity ',this.type,'(',this.id,') lost effect ',effect,' despite never having gained it.');};Entity.prototype.toggleCorrupted=function()
{this.corrupted=!this.corrupted;this.notify('corrupted','change',this.corrupted);};function Hero(id,corner)
{Entity.call(this,id);this.Wits=0;this.Gold=0;this.Spirit=0;this.Magic=0;this.Prestige=0;this.SpiritStones=0;this.followers=new Array();this.bounty=0;this.playerid=undefined;}
Hero.prototype=Object.create(Entity.prototype);Hero.prototype.constructor=Hero;Hero.prototype.equipCard=function(slot,card)
{if(card.slice(0,3)=='FOL')
{this.followers[slot]=card;this.notify('followers','add',card);}
else
Entity.prototype.equipCard.apply(this,arguments);};Hero.prototype.unequipCard=function(slot,card)
{if(card.slice(0,3)=='FOL')
{if(typeof this.followers[slot]!=='undefined')
{this.followers[slot]=undefined;this.notify('followers','remove',card);}
else
console.warn('Hero ',this.type,'(',this.id,') lost follower ',card,' in slot ',slot,' despite having nothing there.');}
else
Entity.prototype.unequipCard.apply(this,arguments);};Hero.prototype.updateBounty=function()
{if((this.bounty>0)&&(this.bounty<3))
{this.bounty++;this.notify('bounty','change',this.bounty);}};Hero.prototype.toggleBounty=function()
{this.bounty=(this.bounty==0)?1:0;this.notify('bounty','change',this.bounty);};Hero.prototype.setBounty=function(level)
{this.bounty=level;this.notify('bounty','change',this.bounty);}
function Player(id,name,location,steam)
{Observable.call(this);this.id=id;this.location=location;this.hasquit=false;this.name=name;this.steam=steam;this.hand=new Array();this.heroid=undefined;Object.defineProperty(this,'hero',{value:undefined,enumerable:false,writable:true,configurable:false,});this.corner=undefined;this.quests=0;Object.defineProperty(this,'_herochanged',{value:Observable.prototype.notify.bind(this,'hero','change'),enumerable:false,writable:false,configurable:false,});}
Player.prototype=Object.create(Observable.prototype);Player.prototype.constructor=Player;Player.prototype.setHero=function(hero,corner)
{this.heroid=hero.id;this.hero=hero;this.hero.playerid=this.id;this.hero.subscribe(this._herochanged);this.notify('hero','set',hero);if(corner)
{this.corner=corner;this.notify('corner','set',corner);}};Player.prototype.gainCard=function(card)
{this.hand.push(card);this.notify('hand','add',card);};Player.prototype.loseCard=function(card)
{var index=this.hand.indexOf(card);if(index>=0)
{this.hand.splice(index,1);this.notify('hand','remove',card);}
else
console.warn('Player ',this.name,' lost a card ',card,' from their hand they never had.');};Player.prototype.nextQuest=function()
{this.quests++;this.notify('quests','change',this.quests);};Player.prototype.quit=function()
{this.hasquit=true;this.notify('hasquit','change',this.hasquit);};function MapTile(type,coords,corner)
{Observable.call(this);if(typeof coords!=='undefined')
this.coords=coords;else
this.coords="-1,-1";Object.defineProperty(this,'u',{get:function(){return Number.parseInt(this.coords.split(',')[0]);},enumerable:false,configurable:false,});Object.defineProperty(this,'v',{get:function(){return Number.parseInt(this.coords.split(',')[1]);},enumerable:false,configurable:false,});this.type=type;this.effects=[];if(type=='Settlement')
this.state={terrorized:false,owner:undefined};else
this.state={};this.peril=undefined;this.perilcard=undefined;this.perilowner=undefined;this.perilbuffs=new Array();this.corner=corner;}
MapTile.prototype=Object.create(Observable.prototype);MapTile.prototype.constructor=MapTile;MapTile.prototype.changeType=function(newtype)
{this.type=newtype;this.notify('type','change',this.type);};MapTile.prototype.setPeril=function(peril,card,owner)
{if(typeof this.peril==='undefined')
{this.peril=peril;this.perilcard=card;this.perilowner=owner;this.perilbuffs=[];this.notify('peril','change',this.peril);}
else
console.warn('Entity ',owner,' tried to set a peril (',peril,') to a tile (',this.coords,') that already had a peril (',this.peril,').');};MapTile.prototype.buffPeril=function(buff)
{if(typeof this.peril!=='undefined')
{this.perilbuffs.push(buff);this.notify('perilbuffs','add',buff);}
else
console.warn('Tried to apply a buff ('+buff+') to a tile without peril.');};MapTile.prototype.clearPeril=function()
{if(typeof this.peril!=='undefined')
{var peril=this.perilcard;this.peril=undefined;this.perilcard=undefined;this.perilowner=undefined;this.perilbuffs=[];this.notify('peril','remove',peril);}
else
console.warn('Tried to clear a peril from a tile without peril.');};MapTile.prototype.hasEffect=function(effect)
{return this.effects.indexOf(effect)>=0;};MapTile.prototype.addEffect=function(effect)
{this.effects.push(effect);this.notify('effects','change',this.effects);};MapTile.prototype.removeEffect=function(effect)
{let idx=this.effects.indexOf(effect);if(idx>=0)
{this.effects.splice(idx,1);this.notify('effects','change',this.effects);}};MapTile.prototype.removeEffects=function()
{for(let i=0;i<arguments.length;i++)
{let idx=this.effects.indexOf(arguments[i]);if(idx>=0)
this.effects.splice(idx,1);}
this.notify('effects','change',this.effects);};MapTile.prototype.terrorizeSettlement=function()
{this.state.terrorized=true;this.state.owner=undefined;this.notify('state','change',this.state);};MapTile.prototype.captureSettlement=function(owner)
{this.state.terrorized=false;this.state.owner=owner;this.notify('state','change',this.state);};function MapMarker(type,coords,title,player)
{Observable.call(this);this.type=type;this.coords=(typeof coords!=='undefined')?coords:'-1,-1';Object.defineProperty(this,'u',{get:function(){return Number.parseInt(this.coords.split(',')[0]);},enumerable:false,configurable:false,});Object.defineProperty(this,'v',{get:function(){return Number.parseInt(this.coords.split(',')[1]);},enumerable:false,configurable:false,});this.title=(typeof title!=='undefined')?title:'';this.player=player;}
MapMarker.prototype=Object.create(Observable.prototype);MapMarker.prototype.constructor=MapMarker;MapMarker.prototype.moveTo=function(coords)
{this.coords=coords;this.notify('coords','change',this.coords);};function MatchContext()
{Observable.call(this);this.active=undefined;this.prestige_leader=0;this.round=-1;this.proclamation='';this.pacts=new Array();}
MatchContext.prototype=Object.create(Observable.prototype);MatchContext.prototype.constructor=MatchContext;MatchContext.prototype.setPrestigeLeader=function(player)
{this.prestige_leader=player;this.notify('prestige_leader','change',player);};MatchContext.prototype.setDeclaration=function(proclamation)
{this.proclamation=proclamation;this.notify('proclamation','change',proclamation);};MatchContext.prototype.setTurn=function(entity)
{this.active=entity;this.notify('active','change',entity);};MatchContext.prototype.nextRound=function()
{this.round++;this.notify('round','change',this.round);};MatchContext.prototype.addPact=function(type,initiator,recipient)
{this.pacts.push({type:type,initiator:initiator,recipient:recipient,});this.notify('pacts','add',this.pacts[this.pacts.length-1]);};MatchContext.prototype.breakPactBetween=function(type,p1,p2)
{for(var i=this.pacts.length;i>=0;i--)
if(((this.pacts[i].initiator==p1)&&(this.pacts[i].recipient==p2))||((this.pacts[i].initiator==p2)&&(this.pacts[i].recipient==p1)))
this.pacts.splice(i,1);this.notify('pacts','change');};MatchContext.prototype.clearPactsFor=function(player)
{for(var i=this.pacts.length-1;i>=0;i--)
if((this.pacts[i].initiator==player)||(this.pacts[i].recipient==player))
this.pacts.splice(i,1);this.notify('pacts','change');};MatchContext.prototype.serialize=function()
{return JSON.stringify(this);};MatchContext.prototype.deserialize=function(data)
{var obj=JSON.parse(data);this.round=obj.round;this.notify('round','change',this.round);this.active=obj.active;this.notify('active','change',this.active);this.prestige_leader=obj.prestige_leader;this.notify('prestige_leader','change',this.prestige_leader);this.proclamation=obj.proclamation;this.notify('proclamation','change',this.proclamation);this.pacts=obj.pacts;this.notify('pacts','change',this.pacts);};function EntityCollection()
{SerializableObservableCollection.call(this);}
EntityCollection.prototype=Object.create(SerializableObservableCollection.prototype);EntityCollection.prototype.constructor=EntityCollection;EntityCollection.prototype.getLivingEntity=function(key,value,strict)
{for(var i=0;i<this.items.length;i++)
if(!this.items[i].dead&&this.items[i].hasOwnProperty(key)&&(this.items[i][key]==value))
return this.items[i];if((typeof strict==='undefined')||strict)
throw new Error(this.constructor.name+": There is no item with "+key.toString()+" = "+value);};EntityCollection.prototype.deserializeItems=function(data)
{var entitycopier=SerializableObservableCollection.getSimpleReviver(Entity);var herocopier=SerializableObservableCollection.getSimpleReviver(Hero);var reviver=function(obj)
{return obj.hasOwnProperty('Prestige')?herocopier(obj):entitycopier(obj);};SerializableObservableCollection.prototype.deserializeItems.call(this,data,reviver);};function PlayerCollection()
{SerializableObservableCollection.call(this);}
PlayerCollection.prototype=Object.create(SerializableObservableCollection.prototype);PlayerCollection.prototype.constructor=PlayerCollection;PlayerCollection.prototype.deserializeItems=function(data,entities)
{var basereviver=SerializableObservableCollection.getSimpleReviver(Player);var reviver=function(obj)
{var plr=basereviver(obj);plr.setHero(entities.getItemById('id',obj.heroid),obj.corner);return plr;};SerializableObservableCollection.prototype.deserializeItems.call(this,data,reviver);};function LevelMap()
{SerializableObservableCollection.call(this);}
LevelMap.prototype=Object.create(SerializableObservableCollection.prototype);LevelMap.prototype.constructor=LevelMap;LevelMap.prototype.deserializeItems=function(data)
{var tilecopier=SerializableObservableCollection.getSimpleReviver(MapTile);SerializableObservableCollection.prototype.deserializeItems.call(this,data,tilecopier);};function MarkerCollection()
{SerializableObservableCollection.call(this);}
MarkerCollection.prototype=Object.create(SerializableObservableCollection.prototype);MarkerCollection.prototype.constructor=MarkerCollection;MarkerCollection.prototype.deserializeItems=function(data)
{var markercopier=SerializableObservableCollection.getSimpleReviver(MapMarker);SerializableObservableCollection.prototype.deserializeItems.call(this,data,markercopier);};function MatchState()
{Observable.call(this);this.context=new MatchContext();this.context.subscribe(Observable.prototype.notify.bind(this,'context','change'));this.map=new LevelMap();this.map.subscribe(Observable.prototype.notify.bind(this,'map','change'));this.entities=new EntityCollection();this.entities.subscribe(Observable.prototype.notify.bind(this,'entities','change'));this.markers=new MarkerCollection();this.markers.subscribe(Observable.prototype.notify.bind(this,'markers','change'));this.players=new PlayerCollection();this.players.subscribe(Observable.prototype.notify.bind(this,'players','change'));}
MatchState.prototype=Object.create(Observable.prototype);MatchState.prototype.constructor=MatchState;MatchState.prototype.loadSnapshot=function(data)
{this.context.deserialize(data.context);this.map.deserializeItems(data.map);this.entities.deserializeItems(data.entities);this.markers.deserializeItems(data.markers);this.players.deserializeItems(data.players,this.entities);};MatchState.prototype.getSnapshot=function()
{return{context:this.context.serialize(),map:this.map.serializeItems(),entities:this.entities.serializeItems(),markers:this.markers.serializeItems(),players:this.players.serializeItems(),};};MatchState.prototype.processEvent=function(evt)
{const traders=['TRK38','TRK39','TRK44','TRK45'];const traders_pre=['TRK38PRE','TRK39PRE','TRK44PRE','TRK45PRE'];try
{switch(evt.name)
{case"spawnNPC":this.entities.addNewItem(Entity,evt.entity,evt.type,evt.coords);break;case"spawnHero":{let hero=new Hero(evt.entity);this.entities.addItem(hero);let player=this.players.getItemById('id',evt.player);let corner;switch(evt.coords)
{case'0,0':corner='Northeast';break;case'7,0':corner='Northwest';break;case'3,8':corner='Southwest';break;case'-4,0':corner='Southeast';break;default:if(evt.corner)corner=evt.corner;break;}
player.setHero(hero,corner);};break;case"setupHero":{let hero=this.entities.getItemById('id',evt.entity);hero.setType(evt.type);hero.moveTo(evt.coords);};break;case"moveEntity":this.entities.getItemById('id',evt.entity).moveTo(evt.coords);break;case"attack":{let attacker=this.entities.getItemById('id',evt.attacker);let defender=this.entities.getItemById('id',evt.defender);if((attacker instanceof Hero)&&(defender.type=='King'))
attacker.setBounty(3);};break
case"killEntity":{let ent=this.entities.getItemById('id',evt.entity);if(ent instanceof Hero)
{if(ent.bounty>0)
ent.toggleBounty();this.context.clearPactsFor(ent.playerid);}
else
ent.kill();};break;case"applyKingsDecToGuard":if(this.context.proclamation=='DECL_0028')
{let ent=this.entities.getItemById('id',evt.entity);ent.kill();};break;case"addEffect":this.entities.getItemById('id',evt.entity).addEffect(evt.card);break;case"removeEffect":this.entities.getItemById('id',evt.entity).removeEffect(evt.card);break;case"equipCard":this.entities.getItemById('id',evt.entity).equipCard(parseInt(evt.slot),evt.card);break;case"unequipCard":this.entities.getItemById('id',evt.entity).unequipCard(evt.slot,evt.card);break;case"gainCard":this.players.getItemById('id',evt.player).gainCard(evt.card);break;case"loseCard":this.players.getItemById('id',evt.player).loseCard(evt.card);break;case"changeStats":{let ent=this.entities.getItemById('id',evt.entity);let before=ent[evt.stat];ent.changeStat(evt.stat,evt.value);let after=ent[evt.stat];if((evt.stat=='Rot')&&(ent instanceof Hero)&&((before<5)!=(after<5)))
ent.toggleCorrupted();};break;case"gainPact":{let p1=evt.player;let p2=this.entities.getItemById('id',evt.entity).playerid;this.context.addPact(evt.card,p1,p2);};break;case"losePact":this.context.breakPactBetween(evt.card,evt.player1,evt.player2);break;case"toggleBounty":this.entities.getItemById('id',evt.entity).toggleBounty();break;case"addTile":this.map.addNewItem(MapTile,evt.type,evt.coords,evt.corner);break;case"addTileEffect":if(evt.card!='None')
{let tile=this.map.getItemById('coords',evt.coords);tile.addEffect(evt.card);};break;case"playCardOnTile":{let tile=this.map.getItemById('coords',evt.coords);switch(evt.card+'>'+tile.type)
{case'MAG36>Swamp':tile.changeType('Forest');break;case'TRK43>Forest':tile.changeType('Swamp');break;case'TRK46>Settlement':tile.addEffect('TRK46');break;default:{let trdid=traders.indexOf(evt.card);if((trdid>=0)&&(tile.type=='Settlement'))
{tile.removeEffect.apply(tile,traders);tile.removeEffect.apply(tile,traders_pre);tile.addEffect(traders_pre[trdid]);}}}};break;case"putPeril":{let id=(evt.owner<5)?this.players.getItemById('id',evt.owner).hero.id:evt.owner;this.map.getItemById('coords',evt.coords).setPeril(evt.peril,evt.card,id);};break;case"buffPeril":{let tile=this.map.getItemById('peril',evt.peril);tile.buffPeril(evt.card);};break;case"clearPeril":this.map.getItemById('peril',evt.peril).clearPeril();break;case"settlementChangeOwner":{let tile=this.map.getItemById('coords',evt.coords);let entityid;if((evt.reason=='BaneTerrorise')||(evt.reason=='KingsGuardTerrorise')||(evt.reason=='HeroClaim'))
{let entity=this.entities.getLivingEntity('coords',evt.coords,false);entityid=entity?entity.id:undefined;}
else if(evt.entity)
entityid=evt.entity;else if(evt.player)
{let player=this.players.getItemById('id',evt.player);entityid=player.heroid;}
if((evt.reason=='BaneTerrorise')||(evt.reason=='KingsDec')||(evt.reason=='KingsGuardTerrorise')||(evt.reason=='TRK16'))
{tile.terrorizeSettlement();tile.removeEffects('TRK13','TRK37','TRK44','TRK45','TRK46');tile.removeEffect.apply(tile,traders);tile.removeEffect.apply(tile,traders_pre);}
else
{tile.captureSettlement(entityid);}};break;case"predictBane":{let old;while(old=this.markers.getItemById('type','banespawn',false))
this.markers.removeItem(old);this.markers.addNewItem(MapMarker,'banespawn',evt.coords,'Incoming Bane');};break;case"spawnSpiritStone":{this.markers.addNewItem(MapMarker,'stone',evt.coords,'Spirit Stone');};break;case"removeSpiritStone":{for(let i=0;i<this.markers.items.length;i++)
if((this.markers.items[i].type=='stone')&&(this.markers.items[i].coords==evt.coords))
{this.markers.removeItem(this.markers.items[i]);break;}};break;case"setQuest":{let player=this.players.getItemById('id',evt.player);player.nextQuest();this.markers.addNewItem(MapMarker,'quest',evt.coords,Name(player.hero.type)+" quest #"+player.quests,evt.player);};break;case"completeQuest":{let hero=this.entities.getItemById('id',this.context.active);if(!(hero instanceof Hero))return;let quest=this.markers.getItemById('player',hero.playerid,false);if(quest&&(hero.coords==quest.coords))
{this.markers.removeItem(quest);}
else
{let tile=this.map.getItemById('coords',hero.coords);if(tile.hasEffect('TRK44')||tile.hasEffect('TRK45'))
tile.removeEffects('TRK44','TRK45');}};break;case"prestigeLeader":this.context.setPrestigeLeader(evt.player);break;case"declaration":this.context.setDeclaration(evt.type);break;case"playerStart":this.players.addNewItem(Player,evt.player,evt.alias,evt.loc,evt.steam);break;case"playerQuit":this.players.getItemById('id',evt.player).quit();break;case"startTurn":{let entity=evt.entity?evt.entity:this.entities.getItemById('playerid',evt.player).id;this.context.setTurn(entity);};break;case"endTurn":this.context.setTurn(undefined);break;case"nextRound":{this.context.nextRound();if(this.context.round%2==1)
{for(let p=0;p<4;p++)
this.players.items[p].hero.updateBounty();for(let i=0;i<this.map.items.length;i++)
{let item=this.map.items[i];item.removeEffects('MAG30','MAG46');}}
for(let i=0;i<this.map.items.length;i++)
{let item=this.map.items[i];if(item.type=='Settlement')
{item.removeEffects.apply(item,traders);for(let j=0;j<traders_pre.length;j++)
if(item.hasEffect(traders_pre[j]))
{item.removeEffect(traders_pre[j]);item.addEffect(traders[j]);}}}};break;}}
catch(err)
{console.error("Error when processing event: ",evt);throw err;}};</script>
	<script data-loader="true">function ParserItem(owner,name,re,map,action)
{this.name=name;this.owner=owner;this.action=action;this.regexp=re;this.map=map;this.action=(typeof this.action==='function')?action:ParserItem.prototype._noop;}
ParserItem.prototype=Object.create({});ParserItem.prototype.constructor=ParserItem;ParserItem.prototype._noop=function(evt){return evt;};ParserItem.prototype.run=function(line)
{var match;if(match=line.match(this.regexp))
{var evt={};for(var i=0;i<this.map.length;i++)
evt[this.map[i]]=match[i+1];evt.name=this.name;return this.action.call(this.owner.data,evt);}
else
return;};function Parser(fields,items,detectfunc)
{this.data_init=fields;this.data=Object.create(fields);this.items=[];for(var i=0;i<items.length;i++)
this.items.push(new ParserItem(this,items[i].name,items[i].re,items[i].map,items[i].action));this.matchFinderFunc=detectfunc.bind(this.data);}
Parser.prototype=Object.create({});Parser.prototype.constructor=Parser;Parser.prototype._parseLine=function(line,pos)
{var events=[];var evt;for(var i=0;i<this.items.length;i++)
{evt=this.items[i].run(line);if(typeof evt!=='undefined')
events.push(evt);}
return events;};Parser.prototype.findMatches=function(file,linecb)
{this.data=Object.create(this.data_init);let matchfinderfunc=this.matchFinderFunc;if(typeof linecb!=='function')
return Parser._scanFile(file,matchfinderfunc);else
return Parser._scanFile(file,function(line,pos)
{linecb(line,pos);return matchfinderfunc(line,pos);});};Parser.prototype.parseFile=function(file,linecb)
{let linefunc=Parser.prototype._parseLine.bind(this);this.data=Object.create(this.data_init);if(typeof linecb!=='function')
return Parser._scanFile(file,linefunc);else
return Parser._scanFile(file,function(line,pos)
{linecb(line,pos);return linefunc(line);});};Parser._versionToArray=function(v)
{return(v+'.0.0.0').split('.').slice(0,4).map(function(x){return parseInt(x,10);});};Parser._versionComparer=function(v1,v2)
{for(let i=0;i<v1.length;i++)
if(v1[i]<v2[i])return-1;else if(v1[i]>v2[i])return 1;return 0;}
Parser._findClosest=function(version)
{var temp=[];var ver=Parser._versionToArray(version);var vs=Object.keys(Parser.Parsers).map(Parser._versionToArray);for(var n=0;n<4;n++)
{temp=vs.filter(function(v){return v[n]==ver[n];}).sort(Parser._versionComparer);if(temp.length==0)
{let greater=vs.filter(function(v){return v[n]>ver[n];}).sort(Parser._versionComparer);if(greater.length>0)
return greater[0].join('.');else
return vs[vs.length-1].join('.');}
else if(temp.length==1)
return temp[0].join('.');else
vs=temp;}
if(temp.length>0)
return temp[0];else
return undefined;};Parser.Parsers={};Parser.provideParserForFile=function(file)
{return new Promise(function(resolve,reject)
{const slicesize=1*1024;var reader=new FileReader();reader.onloadend=function(event)
{var re=/Build\s*ID:[^0-9]+((?:\d+\.)+\d+)-/ig;var version;var match=re.exec(event.target.result);if(match)
{var v=Parser._findClosest(match[1]);if(typeof v==='undefined')
reject("No matching parser found for version "+match[1]+"!");else
resolve(Parser.Parsers[v]);}
else
reject("No version info found!");};reader.readAsText(file.slice(0,slicesize));});};Parser._UTF8size=function(str)
{var s=str.length;for(var i=str.length-1;i>=0;i--)
{var code=str.charCodeAt(i);if(code>0x7f&&code<=0x7ff)s++;else if(code>0x7ff&&code<=0xffff)s+=2;if(code>=0xDC00&&code<=0xDFFF)i--;}
return s;};Parser._scanFile=function(file,linefunc)
{return new Promise(function(resolve,reject)
{const slicesize=64*1024;const sz=file.size;var position=0;var startpos=0;var buffer="";var values=new Array();var reader=new FileReader();reader.onloadend=function(evt)
{if(evt.target.error)
reject(evt.target.error);buffer+=evt.target.result;for(var i=buffer.indexOf("\n");i>=0;i=buffer.indexOf("\n"))
{var line=buffer.slice(0,i+1);buffer=buffer.slice(i+1);try
{let value=linefunc(line,startpos,sz);if(typeof value!=='undefined')
if(Array.isArray(value))
Array.prototype.push.apply(values,value);else
values.push(value);}
catch(err)
{reject(err);return;}
startpos+=Parser._UTF8size(line);}
position+=slicesize;if(position<sz)
reader.readAsText(file.slice(position,position+slicesize));else
{if(buffer.length>0)
try
{let value=linefunc(buffer,startpos,sz);if(typeof value!=='undefined')
values.push(value);}
catch(err)
{reject(err);return;}
resolve(values);}};reader.readAsText(file.slice(0,slicesize));});}</script>
	<script data-loader="true">Parser.Parsers['1.6.1.0']=new Parser({},[],function(line,pos)
{throw new Error("Sorry, but Armello versions below 1.7 are not supported.");});</script>
	<script data-loader="true">Parser.Parsers['1.7.1.0']=new Parser({heroes_completed:[false,false,false,false],attacker:undefined,re_start:/(\d+:\d+:\d+)\W+Matchmaking: Entering matchmaking state: InGameState/i,re_end:/(\d+:\d+:\d+)\W+Matchmaking: Exiting matchmaking state: InGameState/i,re_player:/Gameplay:\s*\[\s*\w+\s*\] Id: \w+, Name:\s*([^,]+), Network Id:\s*(\w+)\s*, Hero:\s*\w+/i,re_setuphero:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\(-?\d+,-?\d+\)\],/i,chat_prepared:undefined,disconnect_cache:undefined,card_on_hero_cache:undefined,card_on_tile_cache:undefined,},[{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \w+#Sync#Spawn(\w+?)(?:AsAuthority)?#\d+\s*\(Processing\) \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \S+ Spawn(\w+?)(?:AsAuthority)?\s* \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnHero",re:/NetworkGame: \w+ \[Process\] \w+#Sync#\d+ SetupPlayerHero \(Player(\d), (\d+), (\w+)\)/i,map:["player","entity","corner"]},{name:"setupHero",re:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\((-?\d+,-?\d+)\)\],/i,map:["type","entity","player","coords"],action:function(evt)
{var p=Number.parseInt(evt.player)-1;if(!this.heroes_completed[p])
{this.heroes_completed[p]=true;return evt;}}},{name:"moveEntity",re:/Gameplay: Creature\+Message\+SnapPosition: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"moveEntity",re:/Gameplay: Creature\+Message\+MoveEnd: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"attack",re:/Combat:\s+(Attacker|Defender): \[.+?\((\w+)\):/i,map:["role","entity"],action:function(evt)
{if(evt.role==="Attacker")
{this.attacker=evt.entity;return undefined;}
else
{evt.attacker=this.attacker;evt.defender=evt.entity;this.combat_cache={attacker:evt.attacker,attacker_dice:{total:0,parts:[],rolls:[]},defender:evt.defender,defender_dice:{total:0,parts:[],rolls:[]},};delete this.attacker;delete evt.role;delete evt.entity;return evt;}}},{name:"modifyDiceCounts",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\]: (AddDice|RemoveDice)\((\d+)\) from source (.+?) for a total of (\d+)/,map:["entity","type","mod","source","value"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.total=parseInt(evt.value,10);target.parts.push({value:((evt.type=="AddDice")?+1:-1)*parseInt(evt.mod,10),source:evt.source});}},{name:"resolveDice",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\] PushResolution \[SymbolResData: (\w+),(\w+),(-?\d+),(\w+)\]/i,map:["entity","symbol","type","mod","source"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.rolls.push({symbol:evt.symbol,type:evt.type,source:evt.source});}},{name:"combatEnd",re:/Combat: CombatManager\.DoApplyCombat combatResult\.(Attacking|Defending)PlayerResult == CombatResult\.Result\.(\w+)/i,map:["source","result"],action:function(evt)
{if(!this.combat_cache)return undefined;let res=this.combat_cache;delete this.combat_cache;res.outcome=evt.source+"-"+evt.result;res.name=evt.name;return res;}},{name:"killEntity",re:/Gameplay: Creature\+Message\+DeathEnd: Dispatch\(\[(?:[^(]+) \((\d+)\):/i,map:["entity"]},{name:"applyKingsDecToGuard",re:/KingsDec: KingsEffects\+Message\+ApplyEffectInSequence: Dispatch\(\[King's Guard.+?\((\d+)\):/i,map:["entity"]},{name:"predictBane",re:/Gameplay: Tile\+Message\+BaneSpawnSet: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"spawnSpiritStone",re:/Gameplay: Tile\+Message\+SpiritStoneSpawned: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"removeSpiritStone",re:/GameplayVisualization: HeroController\+Message\+SpiritStoneCollectCompleted: Dispatch\((?:\[.+?\])?, \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"addEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"removeEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+LoseStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"equipCard",re:/Gameplay: Creature\+Message\+EquipCard: Dispatch\(\[[^\(]+ \((\w+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\d)/i,map:["entity","card","slot"]},{name:"unequipCard",re:/Gameplay: Creature\+Message\+UnequipCard: Dispatch\(\[[^(]+ \((\w+)\).+?Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\w+), (\d)/i,map:["entity","card","reason","slot"]},{name:"gainCard",re:/Player: Player\+Message\+AddCardToHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \w+, (\w+)\)/i,map:["player","card","source"]},{name:"loseCard",re:/Player: Player\+Message\+RemoveCardFromHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\]\)/i,map:["player","card"]},{name:"changeStats",re:/Gameplay: CreatureStats\+Message\+ChangeStats: Dispatch\(\[StatsChange: (\w+): creature:\[.+ \((\d+)\):.+?\] mod:(-?\d+) now:(-?\d+)\]\)/i,map:["stat","entity","delta","value"]},{name:"playCardOnCreature",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\): .+?\((\d+)\), [^\]]*\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[[^\(]+ \((\d+)\):/i,map:["player1","entity1","card","entity2"]},{name:"preGainPact",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[Hero .+? \((\d+)\):/i,map:["player","card","entity"],action:function(evt)
{this.card_on_hero_cache={player:evt.player,entity:evt.entity,card:evt.card};return undefined;}},{name:"gainPact",re:/Gameplay: HeroPactManager\+Message\+GainPact:/i,map:[],action:function(evt)
{if(this.card_on_hero_cache)
{evt.player=this.card_on_hero_cache.player;evt.entity=this.card_on_hero_cache.entity;evt.card=this.card_on_hero_cache.card;this.card_on_hero_cache=undefined;return evt;}
else
return undefined;}},{name:"losePact",re:/Gameplay: HeroPactManager\+Message\+LosePact: Dispatch\(\[[^(]+ \(\d+\): Player=Player(\d),[^]]*\], \[[^(]+ \(\d+\): Player=Player(\d),[^]]*\]/i,map:["player1","player2"]},{name:"toggleBounty",re:/Gameplay: Bounty\+Message\+BountyActiveChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"toggleCorrupted",re:/Gameplay: Corrupted\+Message\+CorruptedChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"addTile",re:/MapMaking:\s*Creating clan castle tile for quadrant (\w+) on position: \((-?\d+,-?\d+)\),/i,map:["corner","coords"],action:function(evt)
{evt.type="ClanCastle";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating clan castle-adjacent plains tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="Plains";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King's Palace Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingsPalace";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingTile";return evt;}},{name:"addTile",re:/MapMaking:\s*- Created (?:Feature )?Tile of Type: (\w+) at position: \((-?\d+,-?\d+)\),/i,map:["type","coords"]},{name:"putPeril",re:/Peril: Tile\+Message\+AddPeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+\], OwnerId=(\w+)\]\)/i,map:["coords","peril","card","owner"]},{name:"encounterPeril",re:/Gameplay: Creature\+Message\+PerilChallengeBegin: Dispatch\(\[Hero \w+ \((\w+)\): Player=Player(\d+), Pos=\((-?\d+,-?\d+)\)/i,map:["entity","player","coords"]},{name:"takePeril",re:/Player: Player\+Message\+TakePerilEffect: Dispatch\(\[.+?\((\d+)\):.+?\], \[Card \w+: Asset:(\w+).+?\], \[Player .+? \(Player(\d)\):/i,map:["entity","card","player"]},{name:"playCardOnTile",re:/Player: Player\+Message\+PlayCardOnTile: Dispatch\(\[.+?\((\d+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["entity","card","coords"],action:function(evt)
{this.card_on_tile_cache={entity:evt.entity,card:evt.card,coords:evt.coords};return evt;}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+BuffLevelChanged: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+StatusEffectAdded: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"clearPeril",re:/Peril: Tile\+Message\+RemovePeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:\w+ type:\w+ isTemp:\w+\], OwnerId=\w+\]\)/i,map:["coords","peril"]},{name:"addTileEffect",re:/Gameplay: TileStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], StatusEffect\[Source:(\w+),\s*Type:(\w+)\]\)/i,map:["coords","card","type"]},{name:"settlementChangeOwner",re:/Gameplay: Tile\+Message\+(SettlementReleased|SettlementCaptured): Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=Settlement\], [^,]+, (\w+),/i,map:["type","coords","reason"],action:function(evt)
{if((evt.reason=='Card')&&this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.reason=this.card_on_tile_cache.card;this.card_on_tile_cache=undefined;}
return evt;}},{name:"setQuest",re:/Quest: OnSpawnQuestComplete - player: Player(\d), quest: \w+, questTilePos: \((-?\d+,-?\d+)\), success: True/i,map:["player","coords"]},{name:"completeQuest",re:/Gameplay: QuestManager\+Message\+CompleteQuest/i,map:[]},{name:"prestigeLeader",re:/Gameplay:\s+Game\+Message\+NewPrestigeLeader:\s+Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"declaration",re:/\[url=\"kingsdec:\/\/(\w+)\"\]/i,map:["type"]},{name:"playerStart",re:/Gameplay:\s+\[\s*(\w+)\s*\]\s+Id:\s+Player(\d),\s+Name:\s+([^,]+), Network Id:\s*(\w+),/i,map:["loc","player","alias","steam"]},{name:"playerQuit",re:/Matchmaking: NetworkRoomSteam: OnRoomPlayerDisconnected: .+ \(Player(\d)\), error (\w+)/i,map:["player","reason"]},{name:"nextRound",re:/Game: TurnManager\+Message\+PhaseStart: Dispatch\((\w+)\)/i,map:["type"]},{name:"startTurn",re:/Player: Player\+Message\+StartTurn: Dispatch\(\[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"startTurn",re:/AI: NPC\+Message\+StartTurn: Dispatch\(\[.+? \((\w+)\):/i,map:["entity"]},{name:"endTurn",re:/Gameplay: Player\+Message\+EndTurn: Dispatch\(\[Player .+? \(Player(\d)\): .+? \((\w+)\)/i,map:["player","entity"],},{name:"victory",re:/Winner: \[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"chat",re:/NetworkGame: PlayerChat\+Message\+ChatMessageReceived: Dispatch\(Player(\d), (\w+),/i,map:["player","type"],action:function(evt)
{this.chat_prepared=evt;return undefined;}},{name:"chat",re:/Game: \[.+\]: (.+)/i,map:["message"],action:function(evt)
{if(!this.chat_prepared)return undefined;this.chat_prepared.message=evt.message;let e=this.chat_prepared;this.chat_prepared=undefined;return e;}},],function(line,pos)
{var match;var player;if(match=this.re_start.exec(line))
this.matchinfo={starttime:match[1],startpos:pos,endtime:"",endpos:0,players:[]};else if((match=this.re_player.exec(line))&&(typeof this.matchinfo!=='undefined')&&(this.matchinfo.players.length<4))
this.matchinfo.players.push({name:match[1],steam:match[2]});else if(this.matchinfo&&(match=this.re_setuphero.exec(line))&&(player=this.matchinfo.players[parseInt(match[3])-1])&&(!player.hero))
player.hero=match[1];else if((match=this.re_end.exec(line))&&(typeof this.matchinfo!=='undefined'))
{var info=this.matchinfo;delete this.matchinfo;info.endtime=match[1];info.endpos=pos;return info;}});</script>
	<script data-loader="true">Parser.Parsers['1.8.2.0']=new Parser({heroes_completed:[false,false,false,false],attacker:undefined,re_start:/(\d+:\d+:\d+)\W+Matchmaking: Entering matchmaking state: InGameState/i,re_end:/(\d+:\d+:\d+)\W+(?:Matchmaking: Exiting matchmaking state: InGameState|Analytics: (?:AnalyticsController: )?OnAppQuit:)/i,re_player:/Gameplay:\s*\[\s*\w+\s*\] Id: \w+, Name:\s*([^,]+), Network Id:\s*(\w+)\s*, Hero:\s*\w+/i,re_setuphero:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\(-?\d+,-?\d+\)\],/i,chat_prepared:undefined,disconnect_cache:undefined,card_on_hero_cache:undefined,card_on_tile_cache:undefined,},[{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \w+#Sync#Spawn(\w+?)(?:AsAuthority)?#\d+\s*\(Processing\) \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \S+ Spawn(\w+?)(?:AsAuthority)?\s* \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnHero",re:/NetworkGame: \w+ \[Process\] \w+#Sync#\d+ SetupPlayerHero \(Player(\d), (\d+), (\w+)\)/i,map:["player","entity","corner"]},{name:"setupHero",re:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\((-?\d+,-?\d+)\)\],/i,map:["type","entity","player","coords"],action:function(evt)
{var p=Number.parseInt(evt.player)-1;if(!this.heroes_completed[p])
{this.heroes_completed[p]=true;return evt;}}},{name:"moveEntity",re:/Gameplay: Creature\+Message\+SnapPosition: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"moveEntity",re:/Gameplay: Creature\+Message\+MoveEnd: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"attack",re:/Combat:\s+(Attacker|Defender): \[.+?\((\w+)\):/i,map:["role","entity"],action:function(evt)
{if(evt.role==="Attacker")
{this.attacker=evt.entity;return undefined;}
else
{evt.attacker=this.attacker;evt.defender=evt.entity;this.combat_cache={attacker:evt.attacker,attacker_dice:{total:0,parts:[],rolls:[]},defender:evt.defender,defender_dice:{total:0,parts:[],rolls:[]},};delete this.attacker;delete evt.role;delete evt.entity;return evt;}}},{name:"modifyDiceCounts",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\]: (AddDice|RemoveDice)\((\d+)\) from source (.+?) for a total of (\d+)/,map:["entity","type","mod","source","value"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.total=parseInt(evt.value,10);target.parts.push({value:((evt.type=="AddDice")?+1:-1)*parseInt(evt.mod,10),source:evt.source});}},{name:"resolveDice",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\] PushResolution \[SymbolResData: (\w+),(\w+),(-?\d+),(\w+)\]/i,map:["entity","symbol","type","mod","source"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.rolls.push({symbol:evt.symbol,type:evt.type,source:evt.source});}},{name:"combatEnd",re:/Combat: CombatManager\.DoApplyCombat combatResult\.(Attacking|Defending)PlayerResult == CombatResult\.Result\.(\w+)/i,map:["source","result"],action:function(evt)
{if(!this.combat_cache)return undefined;let res=this.combat_cache;delete this.combat_cache;res.outcome=evt.source+"-"+evt.result;res.name=evt.name;return res;}},{name:"killEntity",re:/Gameplay: Creature\+Message\+DeathEnd: Dispatch\(\[(?:[^(]+) \((\d+)\):/i,map:["entity"]},{name:"applyKingsDecToGuard",re:/KingsDec: KingsEffects\+Message\+ApplyEffectInSequence: Dispatch\(\[King's Guard.+?\((\d+)\):/i,map:["entity"]},{name:"predictBane",re:/Gameplay: Tile\+Message\+BaneSpawnSet: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"spawnSpiritStone",re:/Gameplay: Tile\+Message\+SpiritStoneSpawned: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"removeSpiritStone",re:/GameplayVisualization: HeroController\+Message\+SpiritStoneCollectCompleted: Dispatch\((?:\[.+?\])?, \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"addEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"removeEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+LoseStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"equipCard",re:/Gameplay: Creature\+Message\+EquipCard: Dispatch\(\[[^\(]+ \((\w+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\d)/i,map:["entity","card","slot"]},{name:"unequipCard",re:/Gameplay: Creature\+Message\+UnequipCard: Dispatch\(\[[^(]+ \((\w+)\).+?Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\w+), (\d)/i,map:["entity","card","reason","slot"]},{name:"gainCard",re:/Player: Player\+Message\+AddCardToHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \w+, (\w+)\)/i,map:["player","card","source"]},{name:"loseCard",re:/Player: Player\+Message\+RemoveCardFromHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\]\)/i,map:["player","card"]},{name:"changeStats",re:/Gameplay: CreatureStats\+Message\+ChangeStats: Dispatch\(\[StatsChange: (\w+): creature:\[.+ \((\d+)\):.+?\] mod:(-?\d+) now:(-?\d+)\]\)/i,map:["stat","entity","delta","value"]},{name:"playCardOnCreature",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\): .+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[[^\(]+ \((\d+)\):/i,map:["player","card","entity"]},{name:"preGainPact",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[Hero .+? \((\d+)\):/i,map:["player","card","entity"],action:function(evt)
{this.card_on_hero_cache={player:evt.player,entity:evt.entity,card:evt.card};return undefined;}},{name:"gainPact",re:/Gameplay: HeroPactManager\+Message\+GainPact:/i,map:[],action:function(evt)
{if(this.card_on_hero_cache)
{evt.player=this.card_on_hero_cache.player;evt.entity=this.card_on_hero_cache.entity;evt.card=this.card_on_hero_cache.card;this.card_on_hero_cache=undefined;return evt;}
else
return undefined;}},{name:"losePact",re:/Gameplay: HeroPactManager\+Message\+LosePact: Dispatch\(\[[^(]+ \(\d+\): Player=Player(\d),[^]]*\], \[[^(]+ \(\d+\): Player=Player(\d),[^]]*\]/i,map:["player1","player2"]},{name:"toggleBounty",re:/Gameplay: Bounty\+Message\+BountyActiveChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"toggleCorrupted",re:/Gameplay: Corrupted\+Message\+CorruptedChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"addTile",re:/MapMaking:\s*Creating clan castle tile for quadrant (\w+) on position: \((-?\d+,-?\d+)\),/i,map:["corner","coords"],action:function(evt)
{evt.type="ClanCastle";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating clan castle-adjacent plains tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="Plains";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King's Palace Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingsPalace";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingTile";return evt;}},{name:"addTile",re:/MapMaking:\s*- Created (?:Feature )?Tile of Type: (\w+) at position: \((-?\d+,-?\d+)\),/i,map:["type","coords"]},{name:"putPeril",re:/Peril: Tile\+Message\+AddPeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+\], OwnerId=(\w+)\]\)/i,map:["coords","peril","card","owner"]},{name:"encounterPeril",re:/Gameplay: Creature\+Message\+PerilChallengeBegin: Dispatch\(\[Hero \w+ \((\w+)\): Player=Player(\d+), Pos=\((-?\d+,-?\d+)\)/i,map:["entity","player","coords"]},{name:"takePeril",re:/Player: Player\+Message\+TakePerilEffect: Dispatch\(\[.+?\((\d+)\):.+?\], \[Card \w+: Asset:(\w+).+?\], \[Player .+? \(Player(\d)\):/i,map:["entity","card","player"]},{name:"playCardOnTile",re:/Player: Player\+Message\+PlayCardOnTile: Dispatch\(\[.+?\((\d+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["entity","card","coords"],action:function(evt)
{this.card_on_tile_cache={entity:evt.entity,card:evt.card,coords:evt.coords};return evt;}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+SymbolBuffLevelChanged: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+StatusEffectAdded: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"clearPeril",re:/Peril: Tile\+Message\+RemovePeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:\w+ type:\w+ isTemp:\w+\], OwnerId=\w+\]\)/i,map:["coords","peril"]},{name:"addTileEffect",re:/Gameplay: TileStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], StatusEffect\[Source:(\w+),\s*Type:(\w+)\]\)/i,map:["coords","card","type"]},{name:"settlementChangeOwner",re:/Gameplay: Tile\+Message\+(SettlementReleased|SettlementCaptured): Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=Settlement\], [^,]+, (\w+),/i,map:["type","coords","reason"],action:function(evt)
{if((evt.reason=='Card')&&this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.reason=this.card_on_tile_cache.card;this.card_on_tile_cache=undefined;}
return evt;}},{name:"setQuest",re:/Quest: OnSpawnQuestComplete - player: Player(\d), quest: \w+, questTilePos: \((-?\d+,-?\d+)\), success: True/i,map:["player","coords"]},{name:"completeQuest",re:/Gameplay: QuestManager\+Message\+CompleteQuest/i,map:[]},{name:"prestigeLeader",re:/Gameplay:\s+Game\+Message\+NewPrestigeLeader:\s+Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"declaration",re:/\[url=\"kingsdec:\/\/(\w+)\"\]/i,map:["type"]},{name:"playerStart",re:/Gameplay:\s+\[\s*(\w+)\s*\]\s+Id:\s+Player(\d),\s+Name:\s+([^,]+), Network Id:\s*(\w+),/i,map:["loc","player","alias","steam"]},{name:"playerQuit",re:/Matchmaking: NetworkRoomSteam: OnRoomPlayerDisconnected: .+ \(Player(\d)\), error (\w+)/i,map:["player","reason"]},{name:"nextRound",re:/Game: TurnManager\+Message\+PhaseStartForKing: Dispatch\((\w+)\)/i,map:["type"]},{name:"startTurn",re:/Player: Player\+Message\+StartTurn: Dispatch\(\[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"startTurn",re:/AI: NPC\+Message\+StartTurn: Dispatch\(\[.+? \((\w+)\):/i,map:["entity"]},{name:"endTurn",re:/Gameplay: Player\+Message\+EndTurn: Dispatch\(\[Player .+? \(Player(\d)\): .+? \((\w+)\)/i,map:["player","entity"],},{name:"victory",re:/Winner: \[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"chat",re:/NetworkGame: PlayerChat\+Message\+ChatMessageReceived: Dispatch\(Player(\d), (\w+),/i,map:["player","type"],action:function(evt)
{this.chat_prepared=evt;return undefined;}},{name:"chat",re:/Game: \[.+\]: (.+)/i,map:["message"],action:function(evt)
{if(!this.chat_prepared)return undefined;this.chat_prepared.message=evt.message;let e=this.chat_prepared;this.chat_prepared=undefined;return e;}},],function(line,pos)
{var match;var player;if(match=this.re_start.exec(line))
this.matchinfo={starttime:match[1],startpos:pos,endtime:"",endpos:0,players:[]};else if((match=this.re_player.exec(line))&&(typeof this.matchinfo!=='undefined')&&(this.matchinfo.players.length<4))
this.matchinfo.players.push({name:match[1],steam:match[2]});else if(this.matchinfo&&(match=this.re_setuphero.exec(line))&&(player=this.matchinfo.players[parseInt(match[3])-1])&&(!player.hero))
player.hero=match[1];else if((match=this.re_end.exec(line))&&(typeof this.matchinfo!=='undefined'))
{var info=this.matchinfo;delete this.matchinfo;info.endtime=match[1];info.endpos=pos;return info;}});</script>
	<script data-loader="true">Parser.Parsers['1.9.6.0']=new Parser({heroes_completed:[false,false,false,false],re_start:/(\d+:\d+:\d+)\W+Matchmaking: Entering matchmaking state: InGameState/i,re_end:/(\d+:\d+:\d+)\W+(?:Matchmaking: Exiting matchmaking state: InGameState|Analytics: (?:AnalyticsController: )?OnAppQuit:)/i,re_player:/Gameplay:\s*\[\s*\w+\s*\] Id: \w+, Name:\s*([^,]+), Network Id:\s*(\w+)\s*, Hero:\s*\w+/i,re_setuphero:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\(-?\d+,-?\d+\)\],/i,chat_prepared:undefined,disconnect_cache:undefined,card_on_hero_cache:undefined,card_on_tile_cache:undefined,},[{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \w+#Sync#Spawn(\w+?)(?:AsAuthority)?#\d+\s*\(Processing\) \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \S+ Spawn(\w+?)(?:AsAuthority)?\s* \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnHero",re:/NetworkGame: \w+ \[Process\] \w+#Sync#SetupPlayerHero#\d  \(Processing\) \(Player(\d), (\d+), (\w+)\)/i,map:["player","entity","corner"]},{name:"setupHero",re:/\[Hero (\w+) \((\d+)\):\s*Player=Player(\d),\s*Pos=\((-?\d+,-?\d+)\)\],/i,map:["type","entity","player","coords"],action:function(evt)
{var p=Number.parseInt(evt.player)-1;if(!this.heroes_completed[p])
{this.heroes_completed[p]=true;return evt;}}},{name:"moveEntity",re:/Gameplay: Creature\+Message\+SnapPosition: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"moveEntity",re:/Gameplay: Creature\+Message\+MoveEnd: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"attack",re:/Combat:\s+(Attacker|Defender): \[.+?\((\w+)\):/i,map:["role","entity"],action:function(evt)
{if(evt.role==="Attacker")
{this.attacker=evt.entity;return undefined;}
else
{evt.attacker=this.attacker;evt.defender=evt.entity;this.combat_cache={attacker:evt.attacker,attacker_dice:{total:0,parts:[],rolls:[]},defender:evt.defender,defender_dice:{total:0,parts:[],rolls:[]},};delete this.attacker;delete evt.role;delete evt.entity;return evt;}}},{name:"modifyDiceCounts",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\]: (AddDice|RemoveDice)\((\d+)\) from source (.+?) for a total of (\d+)/,map:["entity","type","mod","source","value"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.total=parseInt(evt.value,10);target.parts.push({value:((evt.type=="AddDice")?+1:-1)*parseInt(evt.mod,10),source:evt.source});}},{name:"resolveDice",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\] PushResolution \[SymbolResData: (\w+),(\w+),(-?\d+),(\w+)\]/i,map:["entity","symbol","type","mod","source"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.rolls.push({symbol:evt.symbol,type:evt.type,source:evt.source});}},{name:"combatEnd",re:/Combat: CombatManager\.DoApplyCombat combatResult\.(Attacking|Defending)PlayerResult == CombatResult\.Result\.(\w+)/i,map:["source","result"],action:function(evt)
{if(!this.combat_cache)return undefined;let res=this.combat_cache;delete this.combat_cache;res.outcome=evt.source+"-"+evt.result;res.name=evt.name;return res;}},{name:"killEntity",re:/Gameplay: Creature\+Message\+DeathEnd: Dispatch\(\[(?:[^(]+) \((\d+)\):/i,map:["entity"]},{name:"applyKingsDecToGuard",re:/KingsDec: KingsEffects\+Message\+ApplyEffectInSequence: Dispatch\(\[King's Guard.+?\((\d+)\):/i,map:["entity"]},{name:"predictBane",re:/Gameplay: Tile\+Message\+BaneSpawnSet: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"spawnSpiritStone",re:/Gameplay: Tile\+Message\+SpiritStoneSpawned: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"removeSpiritStone",re:/GameplayVisualization: HeroController\+Message\+SpiritStoneCollectCompleted: Dispatch\((?:\[.+?\])?, \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"addEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"removeEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+LoseStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+),\s*Type:\w+\s*\]\)/i,map:["entity","card"]},{name:"equipCard",re:/Gameplay: Creature\+Message\+EquipCard: Dispatch\(\[[^\(]+ \((\w+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\d)/i,map:["entity","card","slot"]},{name:"unequipCard",re:/Gameplay: Creature\+Message\+UnequipCard: Dispatch\(\[[^(]+ \((\w+)\).+?Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\w+), (\d)/i,map:["entity","card","reason","slot"]},{name:"gainCard",re:/Player: Player\+Message\+AddCardToHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \w+, (\w+)\)/i,map:["player","card","source"]},{name:"loseCard",re:/Player: Player\+Message\+RemoveCardFromHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\]\)/i,map:["player","card"]},{name:"changeStats",re:/Gameplay: CreatureStats\+Message\+ChangeStats: Dispatch\(\[StatsChange: (\w+): creature:\[.+ \((\d+)\):.+?\] mod:(-?\d+) now:(-?\d+)\]\)/i,map:["stat","entity","delta","value"]},{name:"playCardOnCreature",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\): .+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[[^\(]+ \((\d+)\):/i,map:["player","card","entity"]},{name:"preGainPact",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[Hero .+? \((\d+)\):/i,map:["player","card","entity"],action:function(evt)
{this.card_on_hero_cache={player:evt.player,entity:evt.entity,card:evt.card};return undefined;}},{name:"gainPact",re:/Gameplay: HeroPactManager\+Message\+GainPact:/i,map:[],action:function(evt)
{if(this.card_on_hero_cache)
{evt.player=this.card_on_hero_cache.player;evt.entity=this.card_on_hero_cache.entity;evt.card=this.card_on_hero_cache.card;this.card_on_hero_cache=undefined;return evt;}
else
return undefined;}},{name:"losePact",re:/Gameplay: HeroPactManager\+Message\+LosePact: Dispatch\(\[[^(]+ \(\d+\): Player=Player(\d),[^]]*\], \[[^(]+ \(\d+\): Player=Player(\d),[^]]*\]/i,map:["player1","player2"]},{name:"toggleBounty",re:/Gameplay: Bounty\+Message\+BountyActiveChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"toggleCorrupted",re:/Gameplay: Corrupted\+Message\+CorruptedChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"addTile",re:/MapMaking:\s*Creating clan castle tile for quadrant (\w+) on position: \((-?\d+,-?\d+)\),/i,map:["corner","coords"],action:function(evt)
{evt.type="ClanCastle";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating clan castle-adjacent plains tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="Plains";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King's Palace Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingsPalace";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingTile";return evt;}},{name:"addTile",re:/MapMaking:\s*- Created (?:Feature )?Tile of Type: (\w+) at position: \((-?\d+,-?\d+)\),/i,map:["type","coords"]},{name:"putPeril",re:/Peril: Tile\+Message\+AddPeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+\], OwnerId=(\w+)\]\)/i,map:["coords","peril","card","owner"]},{name:"encounterPeril",re:/Gameplay: Creature\+Message\+PerilChallengeBegin: Dispatch\(\[Hero \w+ \((\w+)\): Player=Player(\d+), Pos=\((-?\d+,-?\d+)\)/i,map:["entity","player","coords"]},{name:"takePeril",re:/Player: Player\+Message\+TakePerilEffect: Dispatch\(\[.+?\((\d+)\):.+?\], \[Card \w+: Asset:(\w+).+?\], \[Player .+? \(Player(\d)\):/i,map:["entity","card","player"]},{name:"playCardOnTile",re:/Player: Player\+Message\+PlayCardOnTile: Dispatch\(\[.+?\((\d+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["entity","card","coords"],action:function(evt)
{this.card_on_tile_cache={entity:evt.entity,card:evt.card,coords:evt.coords};return evt;}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+SymbolBuffLevelChanged: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+StatusEffectAdded: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"clearPeril",re:/Peril: Tile\+Message\+RemovePeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:\w+ type:\w+ isTemp:\w+\], OwnerId=\w+\]\)/i,map:["coords","peril"]},{name:"addTileEffect",re:/Gameplay: TileStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], StatusEffect\[Source:(\w+),\s*Type:(\w+)\]\)/i,map:["coords","card","type"]},{name:"settlementChangeOwner",re:/Gameplay: Tile\+Message\+(SettlementReleased|SettlementCaptured): Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=Settlement\], [^,]+, (\w+),/i,map:["type","coords","reason"],action:function(evt)
{if((evt.reason=='Card')&&this.card_on_tile_cache)
{evt.entity=this.card_on_tile_cache.entity;evt.reason=this.card_on_tile_cache.card;this.card_on_tile_cache=undefined;}
return evt;}},{name:"setQuest",re:/Quest: OnSpawnQuestComplete - player: Player(\d), quest: \w+, questTilePos: \((-?\d+,-?\d+)\), success: True/i,map:["player","coords"]},{name:"completeQuest",re:/Gameplay: QuestManager\+Message\+CompleteQuest/i,map:[]},{name:"prestigeLeader",re:/Gameplay:\s+Game\+Message\+NewPrestigeLeader:\s+Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"declaration",re:/\[url=\"kingsdec:\/\/(\w+)\"\]/i,map:["type"]},{name:"playerStart",re:/Gameplay:\s+\[\s*(\w+)\s*\]\s+Id:\s+Player(\d),\s+Name:\s+([^,]+), Network Id:\s*(\w+),/i,map:["loc","player","alias","steam"]},{name:"playerQuit",re:/Matchmaking: NetworkRoomSteam: OnRoomPlayerDisconnected: .+ \(Player(\d)\), error (\w+)/i,map:["player","reason"]},{name:"nextRound",re:/Game: TurnManager\+Message\+PhaseStartForKing: Dispatch\((\w+)\)/i,map:["type"]},{name:"startTurn",re:/Player: Player\+Message\+StartTurn: Dispatch\(\[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"startTurn",re:/AI: NPC\+Message\+StartTurn: Dispatch\(\[.+? \((\w+)\):/i,map:["entity"]},{name:"endTurn",re:/Gameplay: Player\+Message\+EndTurn: Dispatch\(\[Player .+? \(Player(\d)\): .+? \((\w+)\)/i,map:["player","entity"],},{name:"victory",re:/Winner: \[Player .+ \(Player(\d)\): [^(]+ \((\w+)\)/i,map:["player","entity"]},{name:"chat",re:/NetworkGame: PlayerChat\+Message\+ChatMessageReceived: Dispatch\(Player(\d), (\w+),/i,map:["player","type"],action:function(evt)
{this.chat_prepared=evt;return undefined;}},{name:"chat",re:/Game: \[.+\]: (.+)/i,map:["message"],action:function(evt)
{if(!this.chat_prepared)return undefined;this.chat_prepared.message=evt.message;let e=this.chat_prepared;this.chat_prepared=undefined;return e;}},],function(line,pos)
{var match;var player;if(match=this.re_start.exec(line))
this.matchinfo={starttime:match[1],startpos:pos,endtime:"",endpos:0,players:[]};else if((match=this.re_player.exec(line))&&(typeof this.matchinfo!=='undefined')&&(this.matchinfo.players.length<4))
this.matchinfo.players.push({name:match[1],steam:match[2]});else if(this.matchinfo&&(match=this.re_setuphero.exec(line))&&(player=this.matchinfo.players[parseInt(match[3])-1])&&(!player.hero))
player.hero=match[1];else if((match=this.re_end.exec(line))&&(typeof this.matchinfo!=='undefined'))
{var info=this.matchinfo;delete this.matchinfo;info.endtime=match[1];info.endpos=pos;return info;}});</script>
	<script data-loader="true">Parser.Parsers['1.10.0.0']=new Parser({pre_heroes_completed:{},re_start:/(\d+:\d+:\d+)\W+Matchmaking: Entering matchmaking state: InGameState/i,re_end:/(\d+:\d+:\d+)\W+(?:Matchmaking: Exiting matchmaking state: InGameState|Analytics: (?:AnalyticsController: )?OnAppQuit:)/i,re_player:/Gameplay:\s*\[\s*\w+\s*\] Id: \w+, Name:\s*([^,]+), Network Id:\s*(\w+)\s*, Hero:\s*\w+/i,re_spawnhero:/NetworkGame: \w+ \[Process\] \w+#Sync#SetupPlayerHero#\d\s+\(Processing\) \(Player(\d), (\d+),/i,re_setuphero:/\[Hero (\w+) \((\d+)\):/i,heroes_completed:{},player_quit_events:[false,false,false,false],chat_prepared:undefined,disconnect_cache:undefined,card_on_hero_cache:undefined,card_on_tile_cache:undefined,},[{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \w+#Sync#Spawn(\w+?)(?:AsAuthority)?#\d+\s*\(Processing\) \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \S+ Spawn(\w+?)(?:AsAuthority)?\s* \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnHero",re:/NetworkGame: \w+ \[Process\] \w+#Sync#SetupPlayerHero#\d  \(Processing\) \(Player(\d), (\d+), \((-?\d+,-?\d+)\)/i,map:["player","entity","coords"]},{name:"setupHero",re:/\[Hero (\w+) \((\d+)\):.*?Pos=\((-?\d+,-?\d+)\)/i,map:["type","entity","coords"],action:function(evt)
{if(!this.heroes_completed[evt.entity])
{this.heroes_completed[evt.entity]=true;return evt;}}},{name:"moveEntity",re:/Gameplay: Creature\+Message\+SnapPosition: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"moveEntity",re:/Gameplay: Creature\+Message\+MoveEnd: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"attack",re:/Combat:\s+(Attacker|Defender): \[.+?\((\d+)\):/i,map:["role","entity"],action:function(evt)
{if(evt.role==="Attacker")
{this.attacker=evt.entity;return undefined;}
else
{evt.attacker=this.attacker;evt.defender=evt.entity;this.combat_cache={attacker:evt.attacker,attacker_dice:{total:0,parts:[],rolls:[]},defender:evt.defender,defender_dice:{total:0,parts:[],rolls:[]},};delete this.attacker;delete evt.role;delete evt.entity;return evt;}}},{name:"modifyDiceCounts",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\]: (AddDice|RemoveDice)\((\d+)\) from source (.+?) for a total of (\d+)/,map:["entity","type","mod","source","value"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.total=parseInt(evt.value,10);target.parts.push({value:((evt.type=="AddDice")?+1:-1)*parseInt(evt.mod,10),source:evt.source});}},{name:"resolveDice",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\] PushResolution \[SymbolResData: (\w+),(\w+),(-?\d+),(\w+)\]/i,map:["entity","symbol","type","mod","source"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.rolls.push({symbol:evt.symbol,type:evt.type,source:evt.source});}},{name:"combatEnd",re:/Combat: CombatManager\.DoApplyCombat combatResult\.(Attacking|Defending)PlayerResult == CombatResult\.Result\.(\w+)/i,map:["source","result"],action:function(evt)
{if(!this.combat_cache)return undefined;let res=this.combat_cache;delete this.combat_cache;res.outcome=evt.source+"-"+evt.result;res.name=evt.name;return res;}},{name:"killEntity",re:/Gameplay: Creature\+Message\+DeathEnd: Dispatch\(\[(?:[^(]+) \((\d+)\):/i,map:["entity"]},{name:"applyKingsDecToGuard",re:/KingsDec: KingsEffects\+Message\+ApplyEffectInSequence: Dispatch\(\[King's Guard.+?\((\d+)\):/i,map:["entity"]},{name:"predictBane",re:/Gameplay: Tile\+Message\+BaneSpawnSet: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"spawnSpiritStone",re:/Gameplay: Tile\+Message\+SpiritStoneSpawned: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"removeSpiritStone",re:/GameplayVisualization: HeroController\+Message\+SpiritStoneCollectCompleted: Dispatch\(.+?, \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"addEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+)/i,map:["entity","card"]},{name:"removeEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+LoseStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+)/i,map:["entity","card"]},{name:"equipCard",re:/Gameplay: Creature\+Message\+EquipCard: Dispatch\(\[[^\(]+ \((\w+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\d)/i,map:["entity","card","slot"]},{name:"unequipCard",re:/Gameplay: Creature\+Message\+UnequipCard: Dispatch\(\[[^(]+ \((\w+)\).+?Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\w+), (\d)/i,map:["entity","card","reason","slot"]},{name:"gainCard",re:/Player: Player\+Message\+AddCardToHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \w+, (\w+)\)/i,map:["player","card","source"]},{name:"loseCard",re:/Player: Player\+Message\+RemoveCardFromHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\]\)/i,map:["player","card"]},{name:"changeStats",re:/Gameplay: CreatureStats\+Message\+ChangeStats: Dispatch\(\[StatsChange: (\w+): creature:\[.+ \((\d+)\):.+?\] mod:(-?\d+) now:(-?\d+)\]\)/i,map:["stat","entity","delta","value"]},{name:"playCardOnCreature",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[[^\(]+ \((\d+)\):/i,map:["player","card","entity"]},{name:"preGainPact",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[Hero [^\(]+ \((\d+)\):/i,map:["player","card","entity"],action:function(evt)
{this.card_on_hero_cache={player:evt.player,entity:evt.entity,card:evt.card};return undefined;}},{name:"gainPact",re:/Gameplay: HeroPactManager\+Message\+GainPact:/i,map:[],action:function(evt)
{if(this.card_on_hero_cache)
{evt.player=this.card_on_hero_cache.player;evt.entity=this.card_on_hero_cache.entity;evt.card=this.card_on_hero_cache.card;this.card_on_hero_cache=undefined;return evt;}
else
return undefined;}},{name:"toggleBounty",re:/Gameplay: SpecialStatusManager\+Message\+StatusUpdated: Dispatch\(\[Hero \w+ \((\d+)\):.+?\], LeagueOfGeeks.ArmelloEngine.Bounty,/i,map:["entity"]},{name:"toggleCorrupted",re:/Gameplay: Corrupted\+Message\+CorruptedChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"addTile",re:/MapMaking:\s*Creating clan castle tile for quadrant (\w+) on position: \((-?\d+,-?\d+)\),/i,map:["corner","coords"],action:function(evt)
{evt.type="ClanCastle";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating clan castle-adjacent plains tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="Plains";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King's Palace Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingsPalace";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingTile";return evt;}},{name:"addTile",re:/MapMaking:\s*- Created (?:Feature )?Tile of Type: (\w+) at position: \((-?\d+,-?\d+)\),/i,map:["type","coords"]},{name:"putPeril",re:/Peril: Tile\+Message\+AddPeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+\], OwnerId=(\w+)\]\)/i,map:["coords","peril","card","owner"]},{name:"encounterPeril",re:/Gameplay: Creature\+Message\+PerilChallengeBegin: Dispatch\(\[Hero \w+ \((\w+)\):.*?Pos=\((-?\d+,-?\d+)\)/i,map:["entity","coords"]},{name:"takePeril",re:/Player: Player\+Message\+TakePerilEffect: Dispatch\(\[.+?\((\d+)\):.+?\], \[Card \w+: Asset:(\w+).+?\], \[Player .+? \(Player(\d)\):/i,map:["entity","card","player"]},{name:"playCardOnTile",re:/Player: Player\+Message\+PlayCardOnTile: Dispatch\(\[Player.+?\(Player(\d)\):.+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["player","card","coords"],action:function(evt)
{this.card_on_tile_cache={player:evt.player,card:evt.card,coords:evt.coords};return evt;}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+SymbolBuffLevelChanged: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+StatusEffectAdded: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"clearPeril",re:/Peril: Tile\+Message\+RemovePeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:\w+ type:\w+ isTemp:\w+\], OwnerId=\w+\]\)/i,map:["coords","peril"]},{name:"addTileEffect",re:/Gameplay: TileStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], StatusEffect\[Source:(\w+)[^,]*,\s*Type:(\w+)\]\)/i,map:["coords","card","type"]},{name:"settlementChangeOwner",re:/Gameplay: Tile\+Message\+(SettlementReleased|SettlementCaptured): Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=Settlement\], [^,]+, (\w+),/i,map:["type","coords","reason"],action:function(evt)
{if((evt.reason=='Card')&&this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.reason=this.card_on_tile_cache.card;this.card_on_tile_cache=undefined;}
return evt;}},{name:"setQuest",re:/Quest: OnSpawnQuestComplete - player: Player(\d), quest: \w+, questTilePos: \((-?\d+,-?\d+)\), success: True/i,map:["player","coords"]},{name:"completeQuest",re:/Gameplay: QuestManager\+Message\+CompleteQuest/i,map:[]},{name:"prestigeLeader",re:/Gameplay:\s+Game\+Message\+NewPrestigeLeader:\s+Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"declaration",re:/\[url=\"kingsdec:\/\/(\w+)\"\]/i,map:["type"]},{name:"playerStart",re:/Gameplay:\s+\[\s*(\w+)\s*\]\s+Id:\s+Player(\d),\s+Name:\s+([^,]+), Network Id:\s*(\w+),/i,map:["loc","player","alias","steam"]},{name:"playerQuit",re:/Matchmaking: NetworkRoomSteam: OnPlayerLeft: .+? \(Player(\d)\), (\w+)/i,map:["player","reason"],action:function(evt)
{let p=parseInt(evt.player,10);if(!this.player_quit_events[p-1])
{this.player_quit_events[p-1]=true;return evt;}
else
return undefined;}},{name:"nextRound",re:/Game: TurnManager\+Message\+PhaseStartForKing: Dispatch\((\w+)\)/i,map:["type"]},{name:"startTurn",re:/Player: Player\+Message\+StartTurn: Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"startTurn",re:/AI: NPC\+Message\+StartTurn: Dispatch\(\[.+? \((\w+)\):/i,map:["entity"]},{name:"endTurn",re:/Gameplay: Player\+Message\+EndTurn: Dispatch\(\[Player .+? \(Player(\d)\)/i,map:["player"]},{name:"victory",re:/Winner:\s*\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"chat",re:/NetworkGame: PlayerChat\+Message\+ChatMessageReceived: Dispatch\(Player(\d), (\w+),/i,map:["player","type"],action:function(evt)
{this.chat_prepared=evt;return undefined;}},{name:"chat",re:/Game: \[.+\]: (.+)/i,map:["message"],action:function(evt)
{if(!this.chat_prepared)return undefined;this.chat_prepared.message=evt.message;let e=this.chat_prepared;this.chat_prepared=undefined;return e;}},],function(line,pos)
{var match;var player;if(match=this.re_start.exec(line))
{this.matchinfo={starttime:match[1],startpos:pos,endtime:"",endpos:0,players:[]};this.pre_heroes_completed={};}
else if((match=this.re_player.exec(line))&&(typeof this.matchinfo!=='undefined')&&(this.matchinfo.players.length<4))
this.matchinfo.players.push({name:match[1],steam:match[2]});else if(this.matchinfo&&(match=this.re_spawnhero.exec(line)))
{player=this.matchinfo.players[parseInt(match[1])-1];if(!player.heroid)
player.heroid=match[2];}
else if(this.matchinfo&&(match=this.re_setuphero.exec(line))&&!this.pre_heroes_completed[match[2]])
{for(let p=0;p<4;p++)
if(this.matchinfo.players[p].heroid==match[2])
{this.matchinfo.players[p].hero=match[1];this.pre_heroes_completed[match[2]]=true;break;}}
else if((match=this.re_end.exec(line))&&(typeof this.matchinfo!=='undefined'))
{var info=this.matchinfo;delete this.matchinfo;info.endtime=match[1];info.endpos=pos;return info;}});</script>
	<script data-loader="true">Parser.Parsers['1.11.0.0']=new Parser({pre_heroes_completed:{},re_start:/(\d+:\d+:\d+)\W+Matchmaking: Entering matchmaking state: InGameState/i,re_end:/(\d+:\d+:\d+)\W+(?:Matchmaking: Exiting matchmaking state: InGameState|Analytics: (?:AnalyticsController: )?OnAppQuit:)/i,re_player:/Gameplay:\s*\[\s*\w+\s*\] Id: \w+, Name:\s*([^,]+), Network Id:\s*(\w+)\s*, Hero:\s*\w+/i,re_spawnhero:/NetworkGame: \w+ \[Process\] \w+#Sync#SetupPlayerHero#\d\s+\(Processing\) \(Player(\d), (\d+),/i,re_setuphero:/\[Hero (\w+) \((\d+)\):/i,heroes_completed:{},player_quit_events:[false,false,false,false],chat_prepared:undefined,disconnect_cache:undefined,card_on_hero_cache:undefined,card_on_tile_cache:undefined,},[{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \w+#Sync#Spawn(\w+?)(?:AsAuthority)?#\d+\s*\(Processing\) \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnNPC",re:/NetworkGame: \w+ \[Process\] \S+ Spawn(\w+?)(?:AsAuthority)?\s* \((\d+), \((-?\d+,-?\d+)\)/i,map:["type","entity","coords"]},{name:"spawnHero",re:/NetworkGame: \w+ \[Process\] \w+#Sync#SetupPlayerHero#\d  \(Processing\) \(Player(\d), (\d+), \((-?\d+,-?\d+)\)/i,map:["player","entity","coords"]},{name:"setupHero",re:/\[Hero (\w+) \((\d+)\):.*?Pos=\((-?\d+,-?\d+)\)/i,map:["type","entity","coords"],action:function(evt)
{if(!this.heroes_completed[evt.entity])
{this.heroes_completed[evt.entity]=true;return evt;}}},{name:"moveEntity",re:/Gameplay: Creature\+Message\+SnapPosition: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"moveEntity",re:/Gameplay: Creature\+Message\+MoveEnd: Dispatch\(\[.+? \((\w+)\):.+?Pos=\((-?\d+,-?\d+)\)/,map:["entity","coords"]},{name:"attack",re:/Combat:\s+(Attacker|Defender): \[.+?\((\d+)\):/i,map:["role","entity"],action:function(evt)
{if(evt.role==="Attacker")
{this.attacker=evt.entity;return undefined;}
else
{evt.attacker=this.attacker;evt.defender=evt.entity;this.combat_cache={attacker:evt.attacker,attacker_dice:{total:0,parts:[],rolls:[]},defender:evt.defender,defender_dice:{total:0,parts:[],rolls:[]},};delete this.attacker;delete evt.role;delete evt.entity;return evt;}}},{name:"modifyDiceCounts",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\]: (AddDice|RemoveDice)\((\d+)\) from source (.+?) for a total of (\d+)/,map:["entity","type","mod","source","value"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.total=parseInt(evt.value,10);target.parts.push({value:((evt.type=="AddDice")?+1:-1)*parseInt(evt.mod,10),source:evt.source});}},{name:"resolveDice",re:/Dice: DiceRollConfig\[\[.+? \((\w+)\):.+\]\] PushResolution \[SymbolResData: (\w+),(\w+),(-?\d+),(\w+)\]/i,map:["entity","symbol","type","mod","source"],action:function(evt)
{if(!this.combat_cache)return undefined;let target;if(this.combat_cache.attacker==evt.entity)
target=this.combat_cache.attacker_dice;else if(this.combat_cache.defender==evt.entity)
target=this.combat_cache.defender_dice;else
return undefined;target.rolls.push({symbol:evt.symbol,type:evt.type,source:evt.source});}},{name:"combatEnd",re:/Combat: CombatManager\.DoApplyCombat combatResult\.(Attacking|Defending)PlayerResult == CombatResult\.Result\.(\w+)/i,map:["source","result"],action:function(evt)
{if(!this.combat_cache)return undefined;let res=this.combat_cache;delete this.combat_cache;res.outcome=evt.source+"-"+evt.result;res.name=evt.name;return res;}},{name:"killEntity",re:/Gameplay: Creature\+Message\+DeathEnd: Dispatch\(\[(?:[^(]+) \((\d+)\):/i,map:["entity"]},{name:"applyKingsDecToGuard",re:/KingsDec: KingsEffects\+Message\+ApplyEffectInSequence: Dispatch\(\[King's Guard.+?\((\d+)\):/i,map:["entity"]},{name:"predictBane",re:/Gameplay: Tile\+Message\+BaneSpawnSet: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"spawnSpiritStone",re:/Gameplay: Tile\+Message\+SpiritStoneSpawned: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"removeSpiritStone",re:/GameplayVisualization: HeroController\+Message\+SpiritStoneCollectCompleted: Dispatch\(.+?, \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["coords"]},{name:"addEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+)/i,map:["entity","card"]},{name:"removeEffect",re:/Gameplay: CreatureStatusEffectManager\+Message\+LoseStatusEffect: Dispatch\(\[[^(]+ \((\d+)\):.+?\], StatusEffect\s*\[Source:(\w+)/i,map:["entity","card"]},{name:"equipCard",re:/Gameplay: Creature\+Message\+EquipCard: Dispatch\(\[[^\(]+ \((\w+)\).+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\d)/i,map:["entity","card","slot"]},{name:"unequipCard",re:/Gameplay: Creature\+Message\+UnequipCard: Dispatch\(\[[^(]+ \((\w+)\).+?Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], (\w+), (\d)/i,map:["entity","card","reason","slot"]},{name:"gainCard",re:/Player: Player\+Message\+AddCardToHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \w+, (\w+)\)/i,map:["player","card","source"]},{name:"loseCard",re:/Player: Player\+Message\+RemoveCardFromHand: Dispatch\(\[Player.+?\(Player(\d)\):.+?\[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\]\)/i,map:["player","card"]},{name:"changeStats",re:/Gameplay: CreatureStats\+Message\+ChangeStats: Dispatch\(\[StatsChange: (\w+): creature:\[.+ \((\d+)\):.+?\] mod:(-?\d+) now:(-?\d+)\]\)/i,map:["stat","entity","delta","value"]},{name:"playCardOnCreature",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[[^\(]+ \((\d+)\):/i,map:["player","card","entity"]},{name:"preGainPact",re:/Player: Player\+Message\+PlayCardOnCreature: Dispatch\(\[Player .+? \(Player(\d)\):.+?\], \[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+], \[Hero [^\(]+ \((\d+)\):/i,map:["player","card","entity"],action:function(evt)
{this.card_on_hero_cache={player:evt.player,entity:evt.entity,card:evt.card};return undefined;}},{name:"gainPact",re:/Gameplay: HeroPactManager\+Message\+GainPact:/i,map:[],action:function(evt)
{if(this.card_on_hero_cache)
{evt.player=this.card_on_hero_cache.player;evt.entity=this.card_on_hero_cache.entity;evt.card=this.card_on_hero_cache.card;this.card_on_hero_cache=undefined;return evt;}
else
return undefined;}},{name:"toggleBounty",re:/Gameplay: SpecialStatusManager\+Message\+StatusUpdated: Dispatch\(\[Hero \w+ \((\d+)\):.+?\], LeagueOfGeeks.ArmelloEngine.Bounty,/i,map:["entity"]},{name:"toggleCorrupted",re:/Gameplay: Corrupted\+Message\+CorruptedChanged: Dispatch\(\[[^(]+ \((\d+)\):.+?\]/i,map:["entity"]},{name:"addTile",re:/MapMaking:\s*Creating clan castle tile for quadrant (\w+) on position: \((-?\d+,-?\d+)\),/i,map:["corner","coords"],action:function(evt)
{evt.type="ClanCastle";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating clan castle-adjacent plains tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="Plains";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King's Palace Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingsPalace";return evt;}},{name:"addTile",re:/MapMaking:\s*Creating King Tile on position: \((-?\d+,-?\d+)\),/i,map:["coords"],action:function(evt)
{evt.type="KingTile";return evt;}},{name:"addTile",re:/MapMaking:\s*- Created (?:Feature )?Tile of Type: (\w+) at position: \((-?\d+,-?\d+)\),/i,map:["type","coords"]},{name:"putPeril",re:/Peril: Tile\+Message\+AddPeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:(\w+) type:\w+ isTemp:\w+\], OwnerId=(\w+)\]\)/i,map:["coords","peril","card","owner"]},{name:"encounterPeril",re:/Gameplay: Creature\+Message\+PerilChallengeBegin: Dispatch\(\[Hero \w+ \((\w+)\):.*?Pos=\((-?\d+,-?\d+)\)/i,map:["entity","coords"]},{name:"takePeril",re:/Player: Player\+Message\+TakePerilEffect: Dispatch\(\[.+?\((\d+)\):.+?\], \[Card \w+: Asset:(\w+).+?\], \[Player .+? \(Player(\d)\):/i,map:["entity","card","player"]},{name:"playCardOnTile",re:/Player: Player\+Message\+PlayCardOnTile: Dispatch\(\[Player.+?\(Player(\d)\):.+?\], \[Card \w+: Asset:(\w+) type:\w+ isTemp:\w+\], \[Tile: Pos=\((-?\d+,-?\d+)\),/i,map:["player","card","coords"],action:function(evt)
{this.card_on_tile_cache={player:evt.player,card:evt.card,coords:evt.coords};return evt;}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+SymbolBuffLevelChanged: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"buffPeril",re:/Gameplay: Peril\+Message\+StatusEffectAdded: Dispatch\(\[Peril \((\w+)\):/i,map:["peril"],action:function(evt)
{if(this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.card=this.card_on_tile_cache.card;evt.coords=this.card_on_tile_cache.coords;this.card_on_tile_cache=undefined;return evt;}}},{name:"clearPeril",re:/Peril: Tile\+Message\+RemovePeril: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], \[Peril \((\w+)\): Card=\[Card \d+: Asset:\w+ type:\w+ isTemp:\w+\], OwnerId=\w+\]\)/i,map:["coords","peril"]},{name:"addTileEffect",re:/Gameplay: TileStatusEffectManager\+Message\+GainStatusEffect: Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=\w+\], StatusEffect\[Source:(\w+)[^,]*,\s*Type:(\w+)\]\)/i,map:["coords","card","type"]},{name:"settlementChangeOwner",re:/Gameplay: Tile\+Message\+(SettlementReleased|SettlementCaptured): Dispatch\(\[Tile: Pos=\((-?\d+,-?\d+)\), Type=Settlement\], [^,]+, (\w+),/i,map:["type","coords","reason"],action:function(evt)
{if((evt.reason=='Card')&&this.card_on_tile_cache)
{evt.player=this.card_on_tile_cache.player;evt.reason=this.card_on_tile_cache.card;this.card_on_tile_cache=undefined;}
return evt;}},{name:"setQuest",re:/Quest: OnSpawnQuestComplete - player: Player(\d), quest: \w+, questTilePos: \((-?\d+,-?\d+)\), success: True/i,map:["player","coords"]},{name:"completeQuest",re:/Gameplay: QuestManager\+Message\+CompleteQuest/i,map:[]},{name:"prestigeLeader",re:/Gameplay:\s+Game\+Message\+NewPrestigeLeader:\s+Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"declaration",re:/\[url=\"kingsdec:\/\/(\w+)\"\]/i,map:["type"]},{name:"playerStart",re:/Gameplay:\s+\[\s*(\w+)\s*\]\s+Id:\s+Player(\d),\s+Name:\s+([^,]+), Network Id:\s*(\w+),/i,map:["loc","player","alias","steam"]},{name:"playerQuit",re:/Matchmaking: NetworkRoomSteam: OnPlayerLeft: .+? \(Player(\d)\), (\w+)/i,map:["player","reason"],action:function(evt)
{let p=parseInt(evt.player,10);if(!this.player_quit_events[p-1])
{this.player_quit_events[p-1]=true;return evt;}
else
return undefined;}},{name:"nextRound",re:/Game: TurnManager\+Message\+PhaseStartForKing: Dispatch\((\w+)\)/i,map:["type"]},{name:"startTurn",re:/Player: Player\+Message\+StartTurn: Dispatch\(\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"startTurn",re:/AI: NPC\+Message\+StartTurn: Dispatch\(\[.+? \((\w+)\):/i,map:["entity"]},{name:"endTurn",re:/Gameplay: Player\+Message\+EndTurn: Dispatch\(\[Player .+? \(Player(\d)\)/i,map:["player"]},{name:"victory",re:/Winner:\s*\[Player .+ \(Player(\d)\):/i,map:["player"]},{name:"chat",re:/NetworkGame: PlayerChat\+Message\+ChatMessageReceived: Dispatch\(Player(\d), (\w+),/i,map:["player","type"],action:function(evt)
{this.chat_prepared=evt;return undefined;}},{name:"chat",re:/Game: \[.+\]: (.+)/i,map:["message"],action:function(evt)
{if(!this.chat_prepared)return undefined;this.chat_prepared.message=evt.message;let e=this.chat_prepared;this.chat_prepared=undefined;return e;}},],function(line,pos)
{var match;var player;if(match=this.re_start.exec(line))
{this.matchinfo={starttime:match[1],startpos:pos,endtime:"",endpos:0,players:[]};this.pre_heroes_completed={};}
else if((match=this.re_player.exec(line))&&(typeof this.matchinfo!=='undefined')&&(this.matchinfo.players.length<4))
this.matchinfo.players.push({name:match[1],steam:match[2]});else if(this.matchinfo&&(match=this.re_spawnhero.exec(line)))
{player=this.matchinfo.players[parseInt(match[1])-1];if(!player.heroid)
player.heroid=match[2];}
else if(this.matchinfo&&(match=this.re_setuphero.exec(line))&&!this.pre_heroes_completed[match[2]])
{for(let p=0;p<4;p++)
if(this.matchinfo.players[p].heroid==match[2])
{this.matchinfo.players[p].hero=match[1];this.pre_heroes_completed[match[2]]=true;break;}}
else if((match=this.re_end.exec(line))&&(typeof this.matchinfo!=='undefined'))
{var info=this.matchinfo;delete this.matchinfo;info.endtime=match[1];info.endpos=pos;return info;}});</script>
	<script data-loader="true">function FileProcessor(zone,handler,color1,color2)
{this.zone=zone;if(zone.hasAttribute('for'))
this.input=document.getElementById(zone.getAttribute('for'));this.handler=handler;this.color1=color1;this.color2=color2;this.zone.addEventListener('click',FileProcessor.prototype.Click.bind(this),false);this.zone.addEventListener('dragover',FileProcessor.prototype.DragFileOver.bind(this),false);this.zone.addEventListener('drop',FileProcessor.prototype.FileDropped.bind(this),false);this.zone.addEventListener('dragend',FileProcessor.prototype.FileDragEnd.bind(this),false);this.zone.addEventListener('dragexit',FileProcessor.prototype.FileDragExit.bind(this),false);this.update=FileProcessor.prototype.update.bind(this);}
FileProcessor.prototype=Object.create({});FileProcessor.prototype.disable=function()
{if(('input'in this)&&!this.input.hasAttribute('disabled'))
this.input.setAttribute('disabled','true');};FileProcessor.prototype.enable=function()
{if(('input'in this)&&this.input.hasAttribute('disabled'))
this.input.removeAttribute('disabled');};FileProcessor.prototype.Click=function(evt)
{if(('input'in this)&&this.input.hasAttribute('disabled'))
evt.preventDefault();};FileProcessor.prototype.DoNothing=function(evt){evt.preventDefault();}
FileProcessor.prototype.DragFileOver=function(evt)
{evt.preventDefault();var cls=this.zone.hasAttribute('class')?this.zone.getAttribute('class'):'';if(!/\bdrag\b/.test(cls))
this.zone.setAttribute('class',cls+' drag');};FileProcessor.prototype.FileDragExit=function(evt)
{evt.preventDefault();this.zone.setAttribute('class',this.zone.getAttribute('class').replace(/\s*drag\b/,''));};FileProcessor.prototype.FileDropped=function(evt)
{evt.preventDefault();if(document.getElementById('log').hasAttribute('disabled'))return;this.zone.setAttribute('class',this.zone.getAttribute('class').replace(/\s*drag\b/,''));var file;var dt=evt.dataTransfer;if(dt.items)
{for(let i=0;i<dt.items.length;i++)
if(dt.items[i].kind==='file')
{file=dt.items[i].getAsFile();break;}}
else
{if(dt.files.length>0)
file=dt.files[0];}
if(typeof file!=='undefined')
this.handler(file,this.update);};FileProcessor.prototype.FileDragEnd=function(evt)
{var dt=evt.dataTransfer;if(dt.items)
for(var i=0;i<dt.items.length;i++)
dt.items.remove(i);else
dt.clearData();};FileProcessor.prototype.update=function(rate,message)
{this.zone.style.background="linear-gradient(90deg, "+this.color1+", "+this.color1+" "+rate+"%, "+this.color2+" "+rate+"%, "+this.color2+")";if(typeof message!=='undefined')
this.zone.innerHTML=message;};function LogFileSelected(file,update)
{document.getElementById('log').setAttribute('disabled','true');var recommendedParser;let items=document.getElementById('matches');while(items.firstChild)items.removeChild(items.firstChild);update(0,"Looking for matches in "+file.name);Parser.provideParserForFile(file).then(function(parser)
{recommendedParser=parser;return parser.findMatches(file,function(line,pos)
{update((100.0*pos)/file.size);});}).then(function(matches)
{if(matches.length>0)
{for(var i=0;i<matches.length;i++)
{let item=document.createElement('li');let btn=document.createElement('button');btn.setAttribute('class','loadmatch');btn.innerHTML='Load';item.appendChild(btn);btn.dataslice=file.slice(matches[i].startpos,matches[i].endpos);btn.parser=recommendedParser;let starttime=matches[i].starttime.split(':').map(function(x){return parseInt(x,10)});let endtime=matches[i].endtime.split(':').map(function(x){return parseInt(x,10)});let duration=(endtime[0]*3600+endtime[1]*60+endtime[2])-(starttime[0]*3600+starttime[1]*60+starttime[2]);if(duration<0)duration+=24*3600;let hours=Math.trunc(duration/3600).toString();let minutes=('0'+Math.trunc((duration%3600)/60).toString()).slice(-2);let seconds=('0'+Math.trunc(duration%60).toString()).slice(-2);let durationspan=document.createElement('span');durationspan.setAttribute('class','match-duration');durationspan.innerHTML=hours+':'+minutes+':'+seconds;item.appendChild(durationspan);for(var p=0;p<4;p++)
{let block=document.createElement('span');block.setAttribute('class','participant');let s=sanitize(matches[i].players[p].name);if((typeof matches[i].players[p].steam!=='undefined')&&(matches[i].players[p].steam!='0'))
s='<a href="https://steamcommunity.com/profiles/'+matches[i].players[p].steam+'">'+s+'</a>';if(typeof matches[i].players[p].hero!=='undefined')
s+="("+Name(matches[i].players[p].hero)+")";block.innerHTML=s;item.appendChild(block);}
items.appendChild(item);}
update(100,"Please choose a match to be loaded, or select another file.");}
else
{update(100,"No matches found! Please select another file.");}
document.getElementById('log').removeAttribute('disabled');}).catch(function(err)
{update(0,"Parsing error: "+err.toString());document.getElementById('log').removeAttribute('disabled');console.error(err);});}
function MatchSelected(file,parser,update)
{document.getElementById('log').setAttribute('disabled','true');update(0,"Extracting events...");parser.parseFile(file,function(line,pos)
{update((75.0*pos)/file.size);}).then(function(events)
{var snapshots=[];var list=document.getElementById('turns');var gamebegan=false;var i=0;update(75,"Analyzing events...");var processSomeEvents=function(resolve,reject)
{try
{let target=Math.min(events.length,i+50);while(i<target)
{window.ArmelloMatchState.processEvent(events[i]);if(!gamebegan&&(events[i].name==='nextRound'))
gamebegan=true;let desc=describeEvent(events[i]);if(gamebegan&&(typeof desc!=='undefined'))
{let li=document.createElement('li');li.innerHTML=desc;li.setAttribute('data-event-index',i);li.setAttribute('class','event event-'+events[i].name);let turntakerid=window.ArmelloMatchState.context.active;let turntaker=(turntakerid)?window.ArmelloMatchState.entities.getItemById('id',turntakerid):undefined;if(turntaker)
{if(turntaker.type.slice(0,4)==='Bear')
li.setAttribute('class',li.className+' Bear')
else if(turntaker.type.slice(0,6)==='Rabbit')
li.setAttribute('class',li.className+' Rabbit')
else if(turntaker.type.slice(0,3)==='Rat')
li.setAttribute('class',li.className+' Rat')
else if(turntaker.type.slice(0,4)==='Wolf')
li.setAttribute('class',li.className+' Wolf')
else if(turntaker.type.slice(0,6)==='Bandit')
li.setAttribute('class',li.className+' Bandit')
else if(turntaker.type.slice(0,4)==='King')
li.setAttribute('class',li.className+' King')
else if(turntaker.type.slice(0,4)==='Bane')
li.setAttribute('class',li.className+' Bane')}
if((events[i].name==='nextRound')||(events[i].name==='startTurn'))
{let index=snapshots.push(window.ArmelloMatchState.getSnapshot())-1;li.setAttribute('data-snapshot-index',index);}
list.appendChild(li);}
i++;}
update(75+(25.0*i)/events.length);if(i<events.length)
setTimeout(function(){processSomeEvents(resolve,reject);},0);else
resolve({events:events,snapshots:snapshots});}
catch(err)
{reject(err);}};return new Promise(processSomeEvents);}).then(function(data)
{let storage=document.createElement('script');storage.innerHTML="window.ArmelloMatchEvents = "+JSON.stringify(data.events).replace(/</g,'\\u003c')+";\r\n"+
"window.ArmelloMatchSnapshots = "+JSON.stringify(data.snapshots).replace(/</g,'\\u003c')+";";document.head.appendChild(storage);switchToMainView();let first=document.querySelector('#turns *[data-snapshot-index]')
jumpToEvent(first.getAttribute('data-event-index'),true);}).catch(function(err)
{let log=document.getElementById('log')
if(log)log.removeAttribute('disabled');update(0,"Parsing error: "+err.toString());console.error(err);});}</script>
	<script>function renderMap(canvas,context,highlight)
{let ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);for(let i=0;i<context.map.items.length;i++)
{let tile=context.map.items[i];renderTile(tile,ctx);renderTileEffects(tile,ctx,context.entities);}
for(let i=0;i<context.markers.items.length;i++)
renderMarker(context.markers.items[i],context,ctx);for(let i=0;i<context.entities.items.length;i++)
{let e=context.entities.items[i];if(!e.dead)
renderEntity(e,ctx);}
if(highlight)
{cnv=gridToCanvas(highlight.u,highlight.v);ctx.beginPath();ctx.strokeStyle='white';ctx.lineWidth=4;ctx.arc(cnv.x,cnv.y,ctx.lineWidth+gridToCanvas.tileSize,0,2*Math.PI);ctx.stroke();}}
function gridToCanvas(u,v)
{if((u==gridToCanvas.uKing)&&(v==gridToCanvas.vKing))
{u=1.5;v=4;}
return{x:gridToCanvas.xOffset+gridToCanvas.GridWidth-(u+0.5*v+0.5)*gridToCanvas.uDim,y:gridToCanvas.yOffset+(v*0.75+0.5)*gridToCanvas.vDim};}
gridToCanvas.uSize=8;gridToCanvas.vSize=9;gridToCanvas.uKing=-99;gridToCanvas.vKing=-99;gridToCanvas.tileSize=50;gridToCanvas.xOffset=10;gridToCanvas.yOffset=10;gridToCanvas.uDim=gridToCanvas.tileSize*Math.sqrt(3);gridToCanvas.vDim=gridToCanvas.tileSize*2;gridToCanvas.GridWidth=gridToCanvas.uSize*gridToCanvas.uDim;gridToCanvas.GridHeight=gridToCanvas.vSize*(1.5*(gridToCanvas.tileSize+2));function getHex(tile,radius)
{const cnv=gridToCanvas(tile.u,tile.v);const sz=radius?radius:(gridToCanvas.tileSize+1);let res=[];for(let i=0;i<6;i++)
res.push({x:cnv.x+sz*Math.cos(i*Math.PI/3+Math.PI/2),y:cnv.y+sz*Math.sin(i*Math.PI/3+Math.PI/2)});return res;}
function strokeTile(ctx,style,hex,verts)
{if(!('stroke'in style))return;ctx.beginPath();ctx.lineCap='round';ctx.lineJoin='round';ctx.strokeStyle=style.stroke;ctx.lineWidth=('lineWidth'in style)?style.lineWidth:1;ctx.moveTo(hex[verts[0]].x,hex[verts[0]].y);for(let i=1;i<verts.length;i++)
ctx.lineTo(hex[verts[i]].x,hex[verts[i]].y);ctx.stroke();}
function renderTile(tile,ctx)
{let style=renderTile.styles[tile.type];if(!style)
{console.warn('No render style for tile',tile);return;}
const cnv=gridToCanvas(tile.u,tile.v);const sz=gridToCanvas.tileSize+1;ctx.beginPath()
ctx.strokeStyle='transparent';ctx.fillStyle=style.fill;let hex=getHex(tile);ctx.moveTo(hex[0].x,hex[0].y);for(let i=1;i<6;i++)
ctx.lineTo(hex[i].x,hex[i].y);ctx.closePath();ctx.fill();if(tile.perilcard)
{if(tile.perilcard.slice(0,2)==='PP')
{let minihex=getHex(tile,gridToCanvas.tileSize-renderTile.styles.KingsPalace.lineWidth/2);switch(tile.perilcard[2])
{case'N':strokeTile(ctx,style,minihex,[1,2,3,4,5]);break;case'S':strokeTile(ctx,style,minihex,[4,5,0,1,2]);break;case'E':strokeTile(ctx,style,minihex,[3,4,5,0]);break;case'W':strokeTile(ctx,style,minihex,[0,1,2,3]);break;}}
else
{let pattern=ctx.createRadialGradient(cnv.x,cnv.y,0,cnv.x,cnv.y,gridToCanvas.tileSize);pattern.addColorStop(0.55,'transparent');pattern.addColorStop(0.75,'black');pattern.addColorStop(0.85,'transparent');ctx.fillStyle=pattern;ctx.beginPath();ctx.arc(cnv.x,cnv.y,gridToCanvas.tileSize,0,2*Math.PI);ctx.fill();}}}
renderTile.styles={ClanCastle:{fill:'dimgray'},KingsPalace:{fill:'royalblue',stroke:'white',lineWidth:5},KingTile:{fill:'transparent'},Plains:{fill:'forestgreen'},Forest:{fill:'darkgreen'},Swamp:{fill:'saddlebrown'},Mountains:{fill:'paleturquoise'},StoneCircle:{fill:'darkturquoise'},Dungeon:{fill:'purple'},Settlement:{fill:'slategray'},};function renderTileEffects(tile,ctx,entities)
{const hex=getHex(tile);if(tile.state.terrorized)
{ctx.strokeStyle=renderTileEffects.effects.terrorized.stroke;ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=renderTileEffects.effects.terrorized.lineWidth;ctx.beginPath();for(let i=0;i<3;i++)
{ctx.moveTo(hex[i].x,hex[i].y);ctx.lineTo(hex[i+3].x,hex[i+3].y);}
ctx.stroke();}
else if(tile.state.owner)
{let owner=entities.getLivingEntity('id',tile.state.owner,false);if(owner&&(owner instanceof Hero))
{const cnv=gridToCanvas(tile.u,tile.v);const sz=gridToCanvas.tileSize*renderTileEffects.effects.owner.radius;let pattern=ctx.createRadialGradient(cnv.x,cnv.y,0,cnv.x,cnv.y,sz);let fill=renderEntity.styles[owner.type.slice(0,-2)].fill;pattern.addColorStop(0,fill);pattern.addColorStop(0.4,fill);pattern.addColorStop(1,renderTile.styles.Settlement.fill);ctx.fillStyle=pattern;let smallhex=getHex(tile,sz);ctx.beginPath();ctx.moveTo(smallhex[0].x,smallhex[0].y);for(let i=1;i<6;i++)
ctx.lineTo(smallhex[i].x,smallhex[i].y);ctx.closePath();ctx.fill();}}
if(tile.hasEffect('TRK46'))
{let smallhex=getHex(tile,gridToCanvas.tileSize-renderTileEffects.effects.walls.lineWidth/2);strokeTile(ctx,renderTileEffects.effects.walls,smallhex,[0,1,2,3,4,5,0]);}
if(tile.hasEffect('TRK37'))
{let smallhex=getHex(tile,gridToCanvas.tileSize-renderTileEffects.effects.spiritwalls.radius);for(let i=0;i<6;i++)
{let pattern=ctx.createRadialGradient(smallhex[i].x,smallhex[i].y,0,smallhex[i].x,smallhex[i].y,renderTileEffects.effects.spiritwalls.radius);pattern.addColorStop(0,renderTileEffects.effects.spiritwalls.colora);pattern.addColorStop(1,renderTileEffects.effects.spiritwalls.colorb);ctx.fillStyle=pattern;ctx.beginPath();ctx.arc(smallhex[i].x,smallhex[i].y,renderTileEffects.effects.spiritwalls.radius,0,2*Math.PI);ctx.fill();}}
if(tile.hasEffect('TRK38')||tile.hasEffect('TRK39')||tile.hasEffect('TRK44')||tile.hasEffect('TRK45'))
{const cnv=gridToCanvas(tile.u,tile.v);let r=Math.trunc(gridToCanvas.tileSize*renderTileEffects.effects.trader.radius);ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=renderTileEffects.effects.trader.text;ctx.font=r.toString()+'px Armello Icons';ctx.fillText('G',cnv.x,cnv.y);}
else if(tile.hasEffect('TRK38PRE')||tile.hasEffect('TRK39PRE')||tile.hasEffect('TRK44PRE')||tile.hasEffect('TRK45PRE'))
{const cnv=gridToCanvas(tile.u,tile.v);let r=Math.trunc(gridToCanvas.tileSize*renderTileEffects.effects.incomingtrader.radius);ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=renderTileEffects.effects.incomingtrader.text;ctx.font=r.toString()+'px Armello Icons';ctx.fillText('G',cnv.x,cnv.y);}
else if(tile.hasEffect('TRK13'))
{const cnv=gridToCanvas(tile.u,tile.v);let r=Math.trunc(gridToCanvas.tileSize*renderTileEffects.effects.industry.radius);ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=renderTileEffects.effects.industry.text;ctx.font=r.toString()+'px Armello Icons';ctx.fillText('P',cnv.x,cnv.y);}
if(tile.hasEffect('MAG30'))
{let smallhex=getHex(tile,gridToCanvas.tileSize-renderTileEffects.effects.thorns.lineWidth);let minihex=getHex(tile,gridToCanvas.tileSize*0.8);ctx.lineCap='round';ctx.lineJoin='round';ctx.lineWidth=renderTileEffects.effects.thorns.lineWidth;ctx.strokeStyle=renderTileEffects.effects.thorns.stroke;ctx.beginPath();ctx.moveTo(minihex[5].x,minihex[5].y);for(let i=0;i<6;i++)
ctx.lineTo(minihex[i].x,minihex[i].y);for(let i=0;i<6;i++)
{ctx.moveTo(minihex[i].x,minihex[i].y);ctx.lineTo(smallhex[i].x,smallhex[i].y);}
ctx.stroke();}
if(tile.hasEffect('MAG46'))
{let hex=getHex(tile,gridToCanvas.tileSize*renderTileEffects.effects.fog.radius);ctx.fillStyle=renderTileEffects.effects.fog.fill;ctx.beginPath();ctx.moveTo(hex[0].x,hex[0].y);for(let i=1;i<6;i++)
ctx.lineTo(hex[i].x,hex[i].y);ctx.closePath();ctx.fill();}}
renderTileEffects.effects={owner:{radius:0.6},terrorized:{stroke:'black',lineWidth:5},walls:{stroke:'white',lineWidth:3},spiritwalls:{colora:'blue',colorb:'cyan',radius:6},industry:{text:'white',radius:0.5},incomingtrader:{text:'black',radius:0.5},trader:{text:'white',radius:0.5},thorns:{stroke:'rgba(0,64,0,1.0)',lineWidth:5},fog:{fill:'rgba(64,64,0,0.7)',radius:1.0},};function renderEntity(entity,ctx)
{let type=(entity instanceof Hero)?entity.type.slice(0,-2):entity.type;let style=renderEntity.styles[type];if(!style)
{console.warn('No render style for entity',entity);return;}
let cnv=gridToCanvas(entity.u,entity.v);let r=gridToCanvas.tileSize*style.size;ctx.beginPath();ctx.arc(cnv.x,cnv.y,r,0,2*Math.PI);ctx.fillStyle=style.fill;ctx.strokeStyle=style.stroke;ctx.lineWidth=style.lineWidth;ctx.fill();ctx.stroke();let text;if(entity instanceof Hero)text=entity.playerid;else if(entity.type==='King')text='K';else if(entity.type==='KingsGuard')text='G';else if(entity.type==='Bane')text='B';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=style.text;ctx.font=r.toString()+'px Arial';ctx.fillText(text,cnv.x,cnv.y);}
renderEntity.styles={King:{size:0.5,fill:'blue',stroke:'darkgoldenrod',lineWidth:4,'text':'yellow'},KingsGuard:{size:0.5,fill:'blue',stroke:'darkgoldenrod',lineWidth:4,'text':'yellow'},Bane:{size:0.5,fill:'darkviolet',stroke:'indigo',lineWidth:4,'text':'fuchsia'},Bandit:{size:0.5,fill:'#333333',stroke:'gold',lineWidth:4,'text':'gold'},Bear:{size:0.5,fill:'#006006',stroke:'gold',lineWidth:4,'text':'gold'},Rabbit:{size:0.5,fill:'#9F7714',stroke:'gold',lineWidth:4,'text':'gold'},Rat:{size:0.5,fill:'#9A2D36',stroke:'gold',lineWidth:4,'text':'gold'},Wolf:{size:0.5,fill:'#3674A3',stroke:'gold',lineWidth:4,'text':'gold'},};function renderMarker(marker,context,ctx)
{switch(marker.type)
{case'quest':renderQuestMarker(marker,context,ctx);break;case'stone':renderStoneMarker(marker,ctx);break;case'banespawn':renderBaneMarker(marker,ctx);break;}}
function renderBaneMarker(marker,ctx)
{let cnv=gridToCanvas(marker.u,marker.v);let r=gridToCanvas.tileSize*0.25;ctx.beginPath();ctx.moveTo(cnv.x-r,cnv.y-r);ctx.lineTo(cnv.x+r,cnv.y+r);ctx.moveTo(cnv.x-r,cnv.y+r);ctx.lineTo(cnv.x+r,cnv.y-r);ctx.strokeStyle='fuchsia';ctx.lineWidth=8;ctx.lineCap='round';ctx.stroke();}
function renderQuestMarker(marker,context,ctx)
{let hero=context.entities.getItemById('playerid',marker.player).type;let style=renderQuestMarker.styles[hero.slice(0,-2)];let cnv=gridToCanvas(marker.u,marker.v);let r=gridToCanvas.tileSize*style.size;ctx.beginPath();ctx.moveTo(cnv.x,cnv.y-r);ctx.lineTo(cnv.x+r,cnv.y);ctx.lineTo(cnv.x,cnv.y+r);ctx.lineTo(cnv.x-r,cnv.y);ctx.closePath();ctx.fillStyle=style.fill;ctx.strokeStyle=style.stroke;ctx.lineWidth=style.lineWidth;ctx.fill();ctx.stroke();ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=style.text;ctx.font=r.toString()+'px Arial';ctx.fillText(marker.player.toString(),cnv.x,cnv.y);}
renderQuestMarker.styles={Bandit:{size:0.7,fill:'#333333',stroke:'gold',lineWidth:2,'text':'gold'},Bear:{size:0.7,fill:'#006006',stroke:'gold',lineWidth:2,'text':'gold'},Rabbit:{size:0.7,fill:'#9F7714',stroke:'gold',lineWidth:2,'text':'gold'},Rat:{size:0.7,fill:'#9A2D36',stroke:'gold',lineWidth:2,'text':'gold'},Wolf:{size:0.7,fill:'#3674A3',stroke:'gold',lineWidth:2,'text':'gold'},};function renderStoneMarker(marker,ctx)
{let cnv=gridToCanvas(marker.u,marker.v);let r=gridToCanvas.tileSize*0.4;let pattern=ctx.createRadialGradient(cnv.x,cnv.y,0,cnv.x,cnv.y,r);pattern.addColorStop(0,'cyan');pattern.addColorStop(1,'blue');ctx.fillStyle=pattern;ctx.beginPath();ctx.arc(cnv.x,cnv.y,r,0,2*Math.PI);ctx.fill();}
function getItemAt(collection,x,y,rate,filterfunc)
{if(collection.items.length==0)return undefined;let idx=-1;let item;let coords;let dsqr=parseFloat("Infinity");for(let i=0;i<collection.items.length;i++)
if((typeof filterfunc!=='function')||filterfunc(collection.items[i]))
{item=collection.items[i];coords=gridToCanvas(item.u,item.v);dcurrent=(coords.x-x)*(coords.x-x)+(coords.y-y)*(coords.y-y);if(dcurrent<dsqr)
{idx=i;dsqr=dcurrent;}}
if(dsqr<=(gridToCanvas.tileSize*gridToCanvas.tileSize*rate*rate))
return{item:collection.items[idx],dist:dsqr};else
return undefined;}</script>
	<script>function sanitize(s)
{return s.replace(/[&<>]/g,function(tag){return sanitize.tagsToReplace[tag]||tag;});}
sanitize.tagsToReplace={'&':'&amp;','<':'&lt;','>':'&gt;'};function describeEntity(entity)
{if(!(entity instanceof Entity))
entity=window.ArmelloMatchState.entities.getItemById('id',entity);return'<span class="entity" data-id="'+entity.id+'">'+Name(entity.type)+'</span>';}
function describeTile(tile)
{let coords;if(!(tile instanceof MapTile))
{coords=tile;tile=window.ArmelloMatchState.map.getItemById('coords',tile,false);}
if(tile)
return'<span class="tile" data-id="'+tile.coords+'">'+Name(tile.type)+' at '+tile.coords+'</span>';else
return'<span class="tile" data-id="'+coords+'">'+coords+'</span>';}
function describeRoll(roll)
{return'<span class="roll roll-'+roll.type+' roll-'+roll.source+'" title="'+roll.source+' '+roll.type+'">'+describeRoll.dicemap[roll.symbol]+'</span>';}
describeRoll.dicemap={Sword:'x',Shield:'u',Sun:'o',Moon:'c',WyldTree:'y',Rot:'q'};function describeEvent(evt)
{let context=window.ArmelloMatchState;switch(evt.name)
{case'spawnSpiritStone':return'Spirit stone spawns at '+describeTile(evt.coords);break;case'moveEntity':return describeEntity(evt.entity)+' moves to '+describeTile(evt.coords)+'.';break;case'attack':return describeEntity(evt.attacker)+' attacks '+describeEntity(evt.defender)+'!';break;case'combatEnd':{let a=describeEntity(evt.attacker);let d=describeEntity(evt.defender);let text;switch(evt.outcome)
{case'Attacking-Lose':text=d+' defends against '+a+'.';break;case'Defending-PushedBack':text=a+' forces '+d+' to retreat.';break;case'Attacking-Defeat':text=d+' kills '+a+'.';break;case'Defending-Defeat':text=a+' kills '+d+'.';break;case'Defending-Routed':text=a+' drives '+d+' before them.';break;case'Attacking-BothDead':text=a+' and '+d+' kill each other.';break;default:text=a+' and '+d+' fight each other.';break;};let adice=evt.attacker_dice.parts.map(function(p){return(p.value>0?'+':'')+p.value.toString()}).join('').slice(1);let ddice=evt.defender_dice.parts.map(function(p){return(p.value>0?'+':'')+p.value.toString()}).join('').slice(1);let ahits=evt.attacker_dice.rolls.filter(function(r){return r.type=='Hit'||r.type=='Pierce'||r.type=='Poison';});let ablocks=evt.attacker_dice.rolls.filter(function(r){return r.type=='Block'||r.type=='Reflect';});ahits.reverse();ablocks.reverse();let dhits=evt.defender_dice.rolls.filter(function(r){return r.type=='Hit'||r.type=='Pierce'||r.type=='Poison';});let dblocks=evt.defender_dice.rolls.filter(function(r){return r.type=='Block'||r.type=='Reflect';});text+='<table class="roll-tooltip"><tr>';text+='<td class="attacker-name">'+a+'</td>';text+='<td class="defender-name">'+d+'</td>';text+='</tr><tr>'
text+='<td class="attacker">'+adice+'='+evt.attacker_dice.parts.reduce(function(a,b){return a+b.value;},0)+' dice</td>';text+='<td class="defender">'+ddice+'='+evt.defender_dice.parts.reduce(function(a,b){return a+b.value;},0)+' dice</td>';text+='</tr><tr>'
text+='<td class="attacker-dice">'+ahits.map(describeRoll).join('')+'</td>';text+='<td class="defender-dice">'+dhits.map(describeRoll).join('')+'</td>';text+='</tr><tr>'
text+='<td class="attacker-dice">'+ablocks.map(describeRoll).join('')+'</td>';text+='<td class="defender-dice">'+dblocks.map(describeRoll).join('')+'</td>';text+='</tr></table>';return text;};break;case'killEntity':{let ent=context.entities.getItemById('id',evt.entity);if(ent instanceof Hero)
return describeEntity(ent)+' returns to the Clan Grounds.';else
return describeEntity(ent)+' dies.';};break;case'equipCard':{let ent=context.entities.getItemById('id',evt.entity);if(ent instanceof Hero)
return describeEntity(ent)+(evt.card.slice(0,3)=='FOL'?' recruits ':' equips ')+PCard(evt.card)+'.';else
return undefined;};break;case'unequipCard':{let ent=context.entities.getItemById('id',evt.entity);if(!(ent instanceof Hero))return;switch(evt.reason)
{case'Discarded':return describeEntity(ent)+' discards '+PCard(evt.card)+'.';break;case'Stolen':return describeEntity(ent)+' has their '+PCard(evt.card)+' stolen from them!';break;case'Fickle':return PCard(evt.card)+' leaves '+describeEntity(ent)+'.';break;default:return describeEntity(ent)+' loses '+PCard(evt.card)+'.';break;}};break;case'gainCard':return describeEntity(context.players.getItemById('id',evt.player).hero)+' gets "'+PCard(evt.card)+'".';break;case'loseCard':return describeEntity(context.players.getItemById('id',evt.player).hero)+' loses "'+PCard(evt.card)+'" from their hand.';break;case'playCardOnCreature':{let ent1=context.entities.getItemById('playerid',evt.player);let ent2=context.entities.getItemById('id',evt.entity);return describeEntity(ent1)+' plays '+PCard(evt.card)+' on '+describeEntity(ent2);};break;case'playCardOnTile':{let entity=evt.entity?context.entities.getItemById('id',evt.entity):context.entities.getItemById('playerid',evt.player);return describeEntity(entity)+' plays '+PCard(evt.card)+' on '+describeTile(evt.coords);};break;case'changeStats':{let ent=context.entities.getItemById('id',evt.entity);if(ent.type&&(evt.stat in ent))
{if((evt.stat==='Health')&&(ent.Health==0))
return describeEntity(ent)+(evt.delta>0?' gains ':' loses ')+Math.abs(evt.delta).toString()+' '+evt.stat+' and dies.';else
return describeEntity(ent)+(evt.delta>0?' gains ':' loses ')+Math.abs(evt.delta).toString()+' '+evt.stat+'.';}
else
return undefined;};break;case'toggleBounty':{let ent=context.entities.getItemById('id',evt.entity);if(ent.bounty>0)
return'There is a bounty on '+describeEntity(ent)+"'s head!";else
return'There is no longer a bounty on '+describeEntity(ent)+"'s head.";};break;case'toggleCorrupted':{let ent=context.entities.getItemById('id',evt.entity);if(ent instanceof Hero)
if(ent.corrupted)
return describeEntity(ent)+' has been corrupted by Rot!';else
return describeEntity(ent)+' is no longer corrupted.';};break;case'putPeril':{let ent=(evt.owner<5)?context.entities.getItemById('playerid',evt.owner):context.entities.getItemById('id',evt.owner);return describeEntity(ent)+' puts '+PCard(evt.card)+' at '+describeTile(evt.coords)+'.';};break;case'encounterPeril':{let tile=context.map.getItemById('coords',evt.coords);let hero=context.entities.getItemById('id',evt.entity);return describeEntity(hero)+' encounters '+PCard(tile.perilcard)+' at '+describeTile(evt.coords)+'.';};break;case'takePeril':{let hero=context.entities.getItemById('playerid',evt.player);return describeEntity(hero)+' fails '+describeEntity(evt.entity)+"'s peril.";};break;case"settlementChangeOwner":{let entity;if(evt.reason.slice(0,3)=='TRK')
entity=evt.entity?context.entities.getItemById('id',evt.entity):context.entities.getItemById('playerid',evt.player);else
entity=context.entities.getLivingEntity('coords',evt.coords,false);switch(evt.reason)
{case'KingsDec':return describeTile(evt.coords)+' has revolted.';break;case'BaneTerrorise':case'KingsGuardTerrorise':case'TRK16':return describeTile(evt.coords)+' has been terrorized by '+describeEntity(entity)+'.';break;default:if(evt.type=='SettlementCaptured')
{if(entity)
return describeTile(evt.coords)+' has been captured by '+describeEntity(entity)+'.';else
return describeTile(evt.coords)+' has been pacified.';};break;}};break;case'completeQuest':return describeEntity(context.context.active)+' has completed a quest.';break;case'prestigeLeader':return describeEntity(context.players.getItemById('id',evt.player).hero)+' is now prestige leader!';break;case'declaration':return'Declaration "'+PDecl(evt.type)+'" is now in effect!';break;case'playerQuit':{let pl=context.players.getItemById('id',evt.player);let s=sanitize(pl.name);switch(evt.reason)
{case'PeerLeftRoom':s+=' has quit the game.';break;case'PeerKickedAFK':s+=' has been kicked for being AFK.';break;default:s+=' disconnected ('+evt.reason+').';}
return s;};break;case'startTurn':{let entity=evt.entity?context.entities.getItemById('id',evt.entity):context.entities.getItemById('playerid',evt.player);return"It's now "+describeEntity(entity)+"'s turn.";};break;case'nextRound':return((context.context.round%2==0)?'Day ':'Night ')+(Math.floor(context.context.round/2)+1).toString();break;case'victory':return sanitize(context.players.getItemById('id',evt.player).name)+' wins the game!';break;case'chat':{let s=evt.message.replace(/\[url="herotooltip:\/\/(\w+?)"\].+?\[\/url\]|\[.+?\]/ig,function(a,b)
{if(b)
return describeEntity(context.entities.getItemById('type',b));else
return'';});return describeEntity(context.players.getItemById('id',evt.player).hero)+' ['+evt.type+']: '+s;};break;default:return undefined;break;}}
function updateHeroFor(player)
{let id=player.id;let hero=player.hero;if(!hero)return;document.querySelector('#players .info[data-player-id="'+id+'"] .hero').innerHTML=' as '+Name(hero.type);let cell=document.querySelector('#players .player[data-player-id="'+id+'"]');cell.setAttribute('data-clan',hero.type.slice(0,-2));for(let i=0;i<3;i++)
{let item=cell.querySelector('.equipped .items[data-index="'+i.toString()+'"]');item.innerHTML=hero.equipment[i]?PCard(hero.equipment[i]):'-';let follower=cell.querySelector('.equipped .followers[data-index="'+i.toString()+'"]');follower.innerHTML=hero.followers[i]?PCard(hero.followers[i]):'-';}
let stats=cell.querySelectorAll('.stats *[data-stat]');for(let i=0;i<stats.length;i++)
{let stat=stats[i].getAttribute('data-stat');if(stat in hero)
stats[i].innerHTML=hero[stat].toString();}
let eff=hero.effects.filter(function(val)
{return(val!=='TRK_DISCOUNT')&&(val!=='DEFAULT_STEALTH')&&(val.slice(0,3)!=='CLN')&&(val.slice(0,3)!=='POW')&&(hero.equipment.indexOf(val)<0)&&(hero.followers.indexOf(val)<0);});let effects=eff.map(PCard).join('; ');let pacts=window.ArmelloMatchState.context.pacts.filter(function(p){return(p.initiator==id)||(p.recipient==id);});for(let i=pacts.length-1;i>=0;i--)
{let s=PCard(pacts[i].type);if(pacts[i].initiator==id)
s+='(to '+Name(window.ArmelloMatchState.players.getItemById('id',pacts[i].recipient).hero.type)+'); ';else
s+='(from '+Name(window.ArmelloMatchState.players.getItemById('id',pacts[i].initiator).hero.type)+'); ';effects=s+effects;}
cell.querySelector('.effects').innerHTML=effects;cell.querySelector('.hand').innerHTML=player.hand.map(Name).join('; ');let caption=document.querySelector('#players .info[data-player-id="'+id+'"]');if(player.hasquit)
caption.setAttribute('data-quit','true');else
caption.removeAttribute('data-quit');if(hero.SpiritStones>=4)
caption.setAttribute('data-spirit-walker','true');else
caption.removeAttribute('data-spirit-walker');let king=window.ArmelloMatchState.entities.getItemById('type','King');if(hero.Rot>king.Rot)
caption.setAttribute('data-rotten','true');else
caption.removeAttribute('data-rotten');if(hero.bounty>0)
caption.setAttribute('data-bounty',hero.bounty.toString());else
caption.removeAttribute('data-bounty');}
function ContextChanged(context,propname,action,value)
{if(propname=='prestige_leader')
for(let i=0;i<window.ArmelloMatchState.players.items.length;i++)
{let id=window.ArmelloMatchState.players.items[i].id;let caption=document.querySelector('#players .info[data-player-id="'+id+'"]');if(context.prestige_leader==id)
caption.setAttribute('data-prestige-leader','true');else
caption.removeAttribute('data-prestige-leader');}
else if(propname=='pacts')
for(let i=0;i<window.ArmelloMatchState.players.items.length;i++)
updateHeroFor(window.ArmelloMatchState.players.items[i]);}
function PlayersChanged(players,propname,propaction,player)
{if((propaction==='change')&&(typeof player==='undefined'))
{for(let id=1;id<=4;id++)
{let plr=players.getItemById('id',id);let caption=document.querySelector('#players .info[data-player-id="'+id+'"] a');caption.parentNode.setAttribute('data-clan',plr.hero.type.slice(0,-2))
caption.innerHTML='['+id.toString()+'] '+sanitize(plr.name);caption.setAttribute('href','https://steamcommunity.com/profiles/'+plr.steam);updateHeroFor(plr);}}
else
updateHeroFor(player);}
function OnUpdate(context,prop,action,value)
{if((prop=='players')||(prop=='entities')||(prop=='map')||(prop=='markers'))
renderMap(document.getElementById('map'),context);}
function jumpToEvent(eventid,scrollto)
{let target=document.querySelector('#turns *[data-event-index="'+eventid+'"]');if(!target)return false;if(!target.hasAttribute('selected'))
{let current=document.querySelector('#turns *[selected]');let currentidx=current?parseInt(current.getAttribute('data-event-index'),10):-1;let eventidx=parseInt(eventid,10);let statenode=target;while(statenode&&!statenode.hasAttribute('data-snapshot-index'))
statenode=statenode.previousElementSibling;let snapshotidx=statenode?parseInt(statenode.getAttribute('data-snapshot-index'),10):0;let starteventidx=statenode?parseInt(statenode.getAttribute('data-event-index'),10):0;if((starteventidx>currentidx)||(eventidx<currentidx))
window.ArmelloMatchState.loadSnapshot(window.ArmelloMatchSnapshots[snapshotidx]);else
starteventidx=currentidx;for(let i=starteventidx+1;i<=eventidx;i++)
window.ArmelloMatchState.processEvent(window.ArmelloMatchEvents[i]);if(current)current.removeAttribute('selected');target.setAttribute('selected','true');if(scrollto)
target.scrollIntoView(true);}
window.location.hash=target.getAttribute('data-event-index');return true;}
function HashChanged(evt)
{if(window.location.hash!=='')
{evt.preventDefault();jumpToEvent(window.location.hash.slice(1),true);}}
function EventClicked(evt)
{let target=evt.target;while(!target.hasAttribute('data-event-index')&&(target.id!=='turns'))
target=target.parentNode;if((target.id==='turns')||target.hasAttribute('selected'))return;evt.preventDefault();jumpToEvent(target.getAttribute('data-event-index'),false);}
function PrevEvent(evt)
{let current=document.querySelector('#turns *[selected]');if(current.previousElementSibling)
jumpToEvent(current.previousElementSibling.getAttribute('data-event-index'),true);}
function NextEvent()
{let current=document.querySelector('#turns *[selected]');if(current.nextElementSibling)
jumpToEvent(current.nextElementSibling.getAttribute('data-event-index'),true);}
function PrevTurn()
{let current=document.querySelector('#turns *[selected]');let matcher=/\bevent-startTurn\b/i;let target=current.previousElementSibling;while(target&&!matcher.test(target.className))
target=target.previousElementSibling;if(target)
jumpToEvent(target.getAttribute('data-event-index'),true);}
function NextTurn()
{let current=document.querySelector('#turns *[selected]');let matcher=/\bevent-startTurn\b/i;let target=current.nextElementSibling;while(target&&!matcher.test(target.className))
target=target.nextElementSibling;if(target)
jumpToEvent(target.getAttribute('data-event-index'),true);}
function FirstEvent()
{let turns=document.querySelector('#turns');jumpToEvent(turns.firstElementChild.getAttribute('data-event-index'),true);}
function LastEvent()
{let turns=document.querySelector('#turns');jumpToEvent(turns.lastElementChild.getAttribute('data-event-index'),true);}
function EventHover(evt)
{if(/\bentity|tile\b/.test(evt.target.className))
{evt.preventDefault();let target=evt.target.getAttribute('data-id');if(EventHover.target!=target)
{let t=(/\btile\b/.test(evt.target.className))?window.ArmelloMatchState.map.getItemById('coords',target,false):window.ArmelloMatchState.entities.getItemById('id',target,false);renderMap(document.getElementById('map'),window.ArmelloMatchState,t);EventHover.target=target;}}
else if(typeof EventHover.target!=='undefined')
{evt.preventDefault();EventHover.target=undefined;renderMap(document.getElementById('map'),window.ArmelloMatchState,undefined);}}
EventHover.target=undefined;function MapHover(evt)
{let rect=evt.target.getBoundingClientRect();let x=(evt.clientX-rect.left)*parseInt(evt.target.getAttribute('width'),10)/rect.width;let y=(evt.clientY-rect.top)*parseInt(evt.target.getAttribute('height'),10)/rect.height;let rx=window.innerWidth-evt.clientX+5;let by=window.innerHeight-evt.clientY+5;let tooltip=document.getElementById('maptooltip');let entity,marker,tile;if(entity=getItemAt(window.ArmelloMatchState.entities,x,y,0.5,function(ent){return!ent.dead;}))
{if(entity.item instanceof Hero)
tooltip.innerHTML=Name(entity.item.type)+'<br />'+sanitize(window.ArmelloMatchState.players.getItemById('id',entity.item.playerid).name);else
tooltip.innerHTML=Name(entity.item.type);tooltip.style='visibility:visible; right:'+rx.toString()+'px; bottom:'+by.toString()+'px';}
else if(marker=getItemAt(window.ArmelloMatchState.markers,x,y,0.7))
{tooltip.innerHTML=marker.item.title;tooltip.style='visibility:visible; right:'+rx.toString()+'px; bottom:'+by.toString()+'px';}
else if(tile=getItemAt(window.ArmelloMatchState.map,x,y,1.0))
{let text=describeTile(tile.item);switch(tile.item.type)
{case'ClanCastle':text+='<br />'+sanitize(window.ArmelloMatchState.players.getItemById('corner',tile.item.corner).name);break;case'Settlement':{if(tile.item.state.terrorized)
text+='<br />Terrorized';else if(tile.item.state.owner)
{let owner=window.ArmelloMatchState.entities.getItemById('id',tile.item.state.owner,false);if(owner)
text+='<br />Owner: '+Name(owner.type);}};break;}
for(let i=0;i<tile.item.effects.length;i++)
text+='<br />'+Name(tile.item.effects[i]);if(tile.item.perilcard)
{let ent=(tile.item.perilowner<5)?window.ArmelloMatchState.players.getItemById('id',tile.item.perilowner).hero:window.ArmelloMatchState.entities.getItemById('id',tile.item.perilowner);text+='<br />Peril: '+Name(tile.item.perilcard)+'('+Name(ent.type)+')';if(tile.item.perilbuffs.length>0)
text+='<br />'+tile.item.perilbuffs.map(Name).join(', ');}
tooltip.innerHTML=text;tooltip.style='visibility:visible; right:'+rx.toString()+'px; bottom:'+by.toString()+'px';}
else
{tooltip.innerHTML='';tooltip.style='';}}
function MapLeave(evt)
{let tooltip=document.getElementById('maptooltip');tooltip.innerHTML='';tooltip.style='';}
function KeyUp(evt)
{switch(evt.key)
{case'Up':case'ArrowUp':{evt.preventDefault();PrevEvent();};break;case'Down':case'ArrowDown':{evt.preventDefault();NextEvent();};break;case'PageUp':{evt.preventDefault();PrevTurn();};break;case'PageDown':{evt.preventDefault();NextTurn();};break;case'Home':{evt.preventDefault();FirstEvent();};break;case'End':{evt.preventDefault();LastEvent();};break;}}
function deleteIfPresent(selector)
{let nodes=document.querySelectorAll(selector);for(let i=0;i<nodes.length;i++)
nodes[i].parentNode.removeChild(nodes[i]);}
function switchToMainView()
{deleteIfPresent('#load');deleteIfPresent('script[data-loader]');document.getElementById('main').removeAttribute('style');let canvas=document.getElementById('map');canvas.setAttribute('width',gridToCanvas.GridWidth+2*gridToCanvas.xOffset);canvas.setAttribute('height',gridToCanvas.GridHeight+2*gridToCanvas.yOffset);canvas.addEventListener('mousemove',MapHover,false);canvas.addEventListener('mouseleave',MapLeave,false);window.ArmelloMatchState.players.subscribe(PlayersChanged);window.ArmelloMatchState.context.subscribe(ContextChanged);window.ArmelloMatchState.subscribe(OnUpdate);let turns=document.getElementById('turns');turns.addEventListener('click',EventClicked,false);turns.addEventListener('mouseover',EventHover,false);window.addEventListener('hashchange',HashChanged,false);window.addEventListener('keyup',KeyUp,false);}
window.addEventListener('load',function(evt){window.ArmelloMatchState=new MatchState();if(('ArmelloMatchEvents'in window)&&('ArmelloMatchSnapshots'in window))
{switchToMainView();let eventchosen=false;if(window.location.hash!=='')
eventchosen=jumpToEvent(window.location.hash.slice(1),true);if(!eventchosen)
{let current=document.querySelector('#turns *[selected]');if(current&&current.getAttribute('data-event-index'))
{current.removeAttribute('selected');eventchosen=jumpToEvent(current.getAttribute('data-event-index'),true);}}
if(!eventchosen)
{let first=document.querySelector('#turns *[data-event-index]')
jumpToEvent(first.getAttribute('data-event-index'),true);}}
else
{if(window.location.hash)
window.location.hash='';var fproc=new FileProcessor(document.getElementById('dropzone'),LogFileSelected,'#888888','transparent');document.getElementById('log').addEventListener('change',function(evt)
{LogFileSelected(evt.target.files[0],fproc.update);},false);document.getElementById('matches').addEventListener('click',function(evt){if(!evt.target.className.match(/\bloadmatch\b/i)||evt.target.hasAttribute('disabled'))return;var buttons=document.getElementById('load').querySelectorAll('.loadmatch');for(let i=0;i<buttons.length;i++)
buttons[i].setAttribute('disabled','true');MatchSelected(evt.target.dataslice,evt.target.parser,fproc.update);},false);let os;if(/^win/i.test(window.navigator.platform))os='windows';else if(/^Mac/i.test(window.navigator.platform))os='mac';else if(/^Linux/i.test(window.navigator.platform))os='linux';else os='unknown';let logpath=document.getElementById('logpath');switch(os)
{case'windows':logpath.innerHTML='%APPDATA%\\..\\LocalLow\\League of Geeks\\Armello\\logs\\';break;case'linux':logpath.innerHTML='~/.config/unity3d/League of Geeks/Armello/logs/';break;case'mac':logpath.innerHTML='~/Library/Application Support/League of Geeks/Armello/logs/';break;}}},false);</script>
</head>
<body>
	<div id="load">
		<label for="log" id="dropzone">Drop Armello log file here or click to browse</label>
		<input accept=".txt" id="log" name="log" type="file">
		<ul id="matches"></ul>
		<div id="help">
			<h1>Armello Match Replay Tool</h1>
			<p>Using this webapp is easy! Create a replay of your match in just three steps:</p>
			<p>1. Click the rectangle above to browse or drop an Armello log file there. You can find those files in <span id="logpath">your user profile folder</span>.</p>
			<p>2. Let the app scan the log file you provided for the matches you've played. Matches ended with game crashing and ongoing matches will not be shown.</p>
			<p>3. Pick a match to be loaded. Once it's done, the app will show a greatly simplified game board and players data. On the left you will see match timeline. Click on an event to jump to that point of the timeline.</p>
			<p>All log files are processed locally, on your device. No privacy leaks, no traffic costs.</p>
			<p>Once the app loads a match, you can save the resulting page to your device - it will keep the data when you re-open it, and will work offline. Feel free to store, share and publish your replays!</p>
		</div>
	</div>
	<div id="main" style="display:none;">
		<table id="players">
			<tr>
				<td class="info" data-clan="wolf" data-player-id="1">
					<a href="" target="_blank">Player name goes here</a>
					<span class="hero"></span>
					<span class="mark-prestige" title="The hero is the Prestige Leader!">P</span>
					<span class="mark-rot" title="The hero has enough Rot to overcome the King!">R</span>
					<span class="mark-stones" title="The hero has enough Spirit Stones to banish the King!">T</span>
					<span class="mark-bounty" title="The hero has bounty on their head!">G</span>
				</td>
				<td class="info" data-clan="rabbit" data-player-id="2">
					<a href="" target="_blank">Player name goes here</a>
					<span class="hero"></span>
					<span class="mark-prestige" title="The hero is the Prestige Leader!">P</span>
					<span class="mark-rot" title="The hero has enough Rot to overcome the King!">R</span>
					<span class="mark-stones" title="The hero has enough Spirit Stones to banish the King!">T</span>
					<span class="mark-bounty" title="The hero has bounty on their head!">G</span>
				</td>
				<td class="info" data-clan="bear" data-player-id="3">
					<a href="" target="_blank">Player name goes here</a>
					<span class="hero"></span>
					<span class="mark-prestige" title="The hero is the Prestige Leader!">P</span>
					<span class="mark-rot" title="The hero has enough Rot to overcome the King!">R</span>
					<span class="mark-stones" title="The hero has enough Spirit Stones to banish the King!">T</span>
					<span class="mark-bounty" title="The hero has bounty on their head!">G</span>
				</td>
				<td class="info" data-clan="rat" data-player-id="4">
					<a href="" target="_blank">Player name goes here</a>
					<span class="hero"></span>
					<span class="mark-prestige" title="The hero is the Prestige Leader!">P</span>
					<span class="mark-rot" title="The hero has enough Rot to overcome the King!">R</span>
					<span class="mark-stones" title="The hero has enough Spirit Stones to banish the King!">T</span>
					<span class="mark-bounty" title="The hero has bounty on their head!">G</span>
				</td>
			</tr>
			<tr>
			<td class="player" data-clan="wolf" data-player-id="1">
				<table class="equipped">
					<tr><td class="items" data-index="0">Lionheart Breastplate</td><td class="followers" data-index="0">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="1">Lionheart Breastplate</td><td class="followers" data-index="1">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="2">Lionheart Breastplate</td><td class="followers" data-index="2">Brilliant Fool</td></tr>
				</table>
				<table class="stats">
					<tr><td class="Fight" data-stat="Fight" title="Fight">F</td><td class="Body" data-stat="Body" title="Body">B</td><td class="Wits" data-stat="Wits" title="Wits">W</td><td class="Spirit" data-stat="Spirit" title="Spirit">S</td><td class="SpiritStones" data-stat="SpiritStones" title="Spirit Stones">Ss</td></tr>
					<tr><td class="Prestige" data-stat="Prestige" title="Prestige">P</td><td class="Health" data-stat="Health" title="Health">H</td><td class="Gold" data-stat="Gold" title="Gold">G</td><td class="Magic" data-stat="Magic" title="Magic">M</td><td class="Rot" data-stat="Rot" title="Rot">R</td></tr>
				</table>
				<div class="effects">Effect 1; Effect 2; Effect 3</div>
				<div class="hand">Card 1; Card 2; Card 3</div>
			</td>
			<td class="player" data-clan="rabbit" data-player-id="2">
				<table class="equipped">
					<tr><td class="items" data-index="0">Lionheart Breastplate</td><td class="followers" data-index="0">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="1">Lionheart Breastplate</td><td class="followers" data-index="1">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="2">Lionheart Breastplate</td><td class="followers" data-index="2">Brilliant Fool</td></tr>
				</table>
				<table class="stats">
					<tr><td class="Fight" data-stat="Fight" title="Fight">F</td><td class="Body" data-stat="Body" title="Body">B</td><td class="Wits" data-stat="Wits" title="Wits">W</td><td class="Spirit" data-stat="Spirit" title="Spirit">S</td><td class="SpiritStones" data-stat="SpiritStones" title="Spirit Stones">Ss</td></tr>
					<tr><td class="Prestige" data-stat="Prestige" title="Prestige">P</td><td class="Health" data-stat="Health" title="Health">H</td><td class="Gold" data-stat="Gold" title="Gold">G</td><td class="Magic" data-stat="Magic" title="Magic">M</td><td class="Rot" data-stat="Rot" title="Rot">R</td></tr>
				</table>
				<div class="effects">Effect 1; Effect 2; Effect 3</div>
				<div class="hand">Card 1; Card 2; Card 3</div>
			</td>
			<td class="player" data-clan="bear" data-player-id="3">
				<table class="equipped">
					<tr><td class="items" data-index="0">Lionheart Breastplate</td><td class="followers" data-index="0">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="1">Lionheart Breastplate</td><td class="followers" data-index="1">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="2">Lionheart Breastplate</td><td class="followers" data-index="2">Brilliant Fool</td></tr>
				</table>
				<table class="stats">
					<tr><td class="Fight" data-stat="Fight" title="Fight">F</td><td class="Body" data-stat="Body" title="Body">B</td><td class="Wits" data-stat="Wits" title="Wits">W</td><td class="Spirit" data-stat="Spirit" title="Spirit">S</td><td class="SpiritStones" data-stat="SpiritStones" title="Spirit Stones">Ss</td></tr>
					<tr><td class="Prestige" data-stat="Prestige" title="Prestige">P</td><td class="Health" data-stat="Health" title="Health">H</td><td class="Gold" data-stat="Gold" title="Gold">G</td><td class="Magic" data-stat="Magic" title="Magic">M</td><td class="Rot" data-stat="Rot" title="Rot">R</td></tr>
				</table>
				<div class="effects">Effect 1; Effect 2; Effect 3</div>
				<div class="hand">Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 1; Card 2; Card 3</div>
			</td>
			<td class="player" data-clan="rat" data-player-id="4">
				<table class="equipped">
					<tr><td class="items" data-index="0">Lionheart Breastplate</td><td class="followers" data-index="0">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="1">Lionheart Breastplate</td><td class="followers" data-index="1">Brilliant Fool</td></tr>
					<tr><td class="items" data-index="2">Lionheart Breastplate</td><td class="followers" data-index="2">Brilliant Fool</td></tr>
				</table>
				<table class="stats">
					<tr><td class="Fight" data-stat="Fight" title="Fight">F</td><td class="Body" data-stat="Body" title="Body">B</td><td class="Wits" data-stat="Wits" title="Wits">W</td><td class="Spirit" data-stat="Spirit" title="Spirit">S</td><td class="SpiritStones" data-stat="SpiritStones" title="Spirit Stones">Ss</td></tr>
					<tr><td class="Prestige" data-stat="Prestige" title="Prestige">P</td><td class="Health" data-stat="Health" title="Health">H</td><td class="Gold" data-stat="Gold" title="Gold">G</td><td class="Magic" data-stat="Magic" title="Magic">M</td><td class="Rot" data-stat="Rot" title="Rot">R</td></tr>
				</table>
				<div class="effects">Effect 1; Effect 2; Effect 3</div>
				<div class="hand">Card 1; Card 2; Card 3</div>
			</td>
			</tr>
		</table>
		<div class="lower">
			<ul id="turns"></ul>
			<div class="mapwrapper">
				<canvas id="map">Your browser doesn't support Canvas!</canvas>
				<div id="maptooltip"></div>
			</div>
		</div>
	</div>
</body>
</html>